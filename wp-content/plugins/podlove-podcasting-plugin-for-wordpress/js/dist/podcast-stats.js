function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _iterableToArrayLimit(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],u=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return l}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}!function(){function t(t,e){"use strict";var n={version:"3.0.2",constants:{CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},_renderlet:null};n.chartRegistry=function(){var t={};function e(e){return e||(e=n.constants.DEFAULT_CHART_GROUP),t[e]||(t[e]=[]),e}return{has:function(e){for(var n in t)if(t[n].indexOf(e)>=0)return!0;return!1},register:function(n,r){r=e(r),t[r].push(n)},deregister:function(n,r){r=e(r);for(var i=0;i<t[r].length;i++)if(t[r][i].anchorName()===n.anchorName()){t[r].splice(i,1);break}},clear:function(e){e?delete t[e]:t={}},list:function(n){return n=e(n),t[n]}}}(),n.registerChart=function(t,e){n.chartRegistry.register(t,e)},n.deregisterChart=function(t,e){n.chartRegistry.deregister(t,e)},n.hasChart=function(t){return n.chartRegistry.has(t)},n.deregisterAllCharts=function(t){n.chartRegistry.clear(t)},n.filterAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].filterAll()},n.refocusAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].focus&&e[r].focus()},n.renderAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].render();null!==n._renderlet&&n._renderlet(t)},n.redrawAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].redraw();null!==n._renderlet&&n._renderlet(t)},n.disableTransitions=!1,n.transition=function(t,e,r,i){if(n.disableTransitions||e<=0)return t;var a=t.transition(i);return(e>=0||void 0!==e)&&(a=a.duration(e)),(r>=0||void 0!==r)&&(a=a.delay(r)),a},n.optionalTransition=function(t,e,r,i){return t?function(t){return n.transition(t,e,r,i)}:function(t){return t}},n.afterTransition=function(t,e){if(t.empty()||!t.duration)e.call(t);else{var n=0;t.each((function(){++n})).on("end",(function(){--n||e.call(t)}))}},n.units={},n.units.integers=function(t,e){return Math.abs(e-t)},n.units.ordinal=function(){throw new Error("dc.units.ordinal should not be called - it is a placeholder")},n.units.fp={},n.units.fp.precision=function(t){var e=function t(e,r){var i=Math.abs((r-e)/t.resolution);return n.utils.isNegligible(i-Math.floor(i))?Math.floor(i):Math.ceil(i)};return e.resolution=t,e},n.round={},n.round.floor=function(t){return Math.floor(t)},n.round.ceil=function(t){return Math.ceil(t)},n.round.round=function(t){return Math.round(t)},n.override=function(t,e,n){var r=t[e];t["_"+e]=r,t[e]=n},n.renderlet=function(t){return arguments.length?(n._renderlet=t,n):n._renderlet},n.instanceOfChart=function(t){return t instanceof Object&&t.__dcFlag__&&!0},n.errors={},n.errors.Exception=function(t){var e=t||"Unexpected internal error";this.message=e,this.toString=function(){return e},this.stack=(new Error).stack},n.errors.Exception.prototype=Object.create(Error.prototype),n.errors.Exception.prototype.constructor=n.errors.Exception,n.errors.InvalidStateException=function(){n.errors.Exception.apply(this,arguments)},n.errors.InvalidStateException.prototype=Object.create(n.errors.Exception.prototype),n.errors.InvalidStateException.prototype.constructor=n.errors.InvalidStateException,n.errors.BadArgumentException=function(){n.errors.Exception.apply(this,arguments)},n.errors.BadArgumentException.prototype=Object.create(n.errors.Exception.prototype),n.errors.BadArgumentException.prototype.constructor=n.errors.BadArgumentException,n.dateFormat=t.timeFormat("%m/%d/%Y"),n.printers={},n.printers.filters=function(t){for(var e="",r=0;r<t.length;++r)r>0&&(e+=", "),e+=n.printers.filter(t[r]);return e},n.printers.filter=function(t){var e="";return null!=t&&(t instanceof Array?t.length>=2?e="["+n.utils.printSingleValue(t[0])+" -> "+n.utils.printSingleValue(t[1])+"]":t.length>=1&&(e=n.utils.printSingleValue(t[0])):e=n.utils.printSingleValue(t)),e},n.pluck=function(t,e){return e?function(n,r){return e.call(n,n[t],r)}:function(e){return e[t]}},n.utils={},n.utils.printSingleValue=function(t){var e=""+t;return t instanceof Date?e=n.dateFormat(t):"string"==typeof t?e=t:n.utils.isFloat(t)?e=n.utils.printSingleValue.fformat(t):n.utils.isInteger(t)&&(e=Math.round(t)),e},n.utils.printSingleValue.fformat=t.format(".2f"),n.utils.toTimeFunc=function(t){return"time"+t.charAt(0).toUpperCase()+t.slice(1)},n.utils.add=function(e,r,i){if("string"==typeof r&&(r=r.replace("%","")),e instanceof Date)return"string"==typeof r&&(r=+r),"millis"===i?new Date(e.getTime()+r):("function"!=typeof(i=i||t.timeDay)&&(i=t[n.utils.toTimeFunc(i)]),i.offset(e,r));if("string"==typeof r){var a=+r/100;return e>0?e*(1+a):e*(1-a)}return e+r},n.utils.subtract=function(e,r,i){if("string"==typeof r&&(r=r.replace("%","")),e instanceof Date)return"string"==typeof r&&(r=+r),"millis"===i?new Date(e.getTime()-r):("function"!=typeof(i=i||t.timeDay)&&(i=t[n.utils.toTimeFunc(i)]),i.offset(e,-r));if("string"==typeof r){var a=+r/100;return e<0?e*(1+a):e*(1-a)}return e-r},n.utils.isNumber=function(t){return t===+t},n.utils.isFloat=function(t){return t===+t&&t!==(0|t)},n.utils.isInteger=function(t){return t===+t&&t===(0|t)},n.utils.isNegligible=function(t){return!n.utils.isNumber(t)||t<n.constants.NEGLIGIBLE_NUMBER&&t>-n.constants.NEGLIGIBLE_NUMBER},n.utils.clamp=function(t,e,n){return t<e?e:t>n?n:t},n.utils.constant=function(t){return function(){return t}};var r,i,a,o,l,u=0;function c(t,e){for(var n=0;n<t.length;n++)if(t[n].key===e)return t[n]}return n.utils.uniqueId=function(){return++u},n.utils.nameToId=function(t){return t.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")},n.utils.appendOrSelect=function(t,e,n){n=n||e;var r=t.select(e);return r.empty()&&(r=t.append(n)),r},n.utils.safeNumber=function(t){return n.utils.isNumber(+t)?+t:0},n.utils.arraysEqual=function(t,e){return t&&e?t.length===e.length&&t.every((function(t,n){return t===e[n]||t.toString()===e[n].toString()})):t===e},n.utils.allChildren=function(t){var e=[];if(e.push(t.path),console.log("currentNode",t),t.children)for(var r=0;r<t.children.length;r++)e=e.concat(n.utils.allChildren(t.children[r]));return e},n.utils.toHierarchy=function(t,e){for(var n={key:"root",children:[]},r=0;r<t.length;r++)for(var i=t[r],a=i.key,o=e(i),l=n,u=0;u<a.length;u++){var s,d=a.slice(0,u+1),f=l.children,h=a[u];u+1<a.length?(void 0===(s=c(f,h))&&(s={key:h,children:[],path:d},f.push(s)),l=s):(s={key:h,value:o,data:i,path:d},f.push(s))}return n},n.utils.getAncestors=function(t){for(var e=[],n=t;n.parent;)e.unshift(n.name),n=n.parent;return e},n.utils.arraysIdentical=function(t,e){var n=t.length;if(n!==e.length)return!1;for(;n--;)if(t[n]!==e[n])return!1;return!0},n.logger=(i={},(r={enableDebugLog:!1,warn:function(t){return console&&(console.warn?console.warn(t):console.log&&console.log(t)),r}}).warnOnce=function(t){return i[t]||(i[t]=!0,n.logger.warn(t)),r},r.debug=function(t){return r.enableDebugLog&&console&&(console.debug?console.debug(t):console.log&&console.log(t)),r},r.deprecate=function(t,e){var n=!1;return function(){return n||(r.warn(e),n=!0),t.apply(this,arguments)}},r),n.config=(l=o=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"],(a={}).defaultColors=function(t){return arguments.length?(l=t,a):(l===o&&n.logger.warnOnce("You are using d3.schemeCategory20c, which has been removed in D3v5. See the explanation at https://github.com/d3/d3/blob/master/CHANGES.md#changes-in-d3-50. DC is using it for backward compatibility, however it will be changed in DCv3.1. You can change it by calling dc.config.defaultColors(newScheme). See https://github.com/d3/d3-scale-chromatic for some alternatives."),l)},a),n.events={current:null},n.events.trigger=function(t,e){e?(n.events.current=t,setTimeout((function(){t===n.events.current&&t()}),e)):t()},n.filters={},n.filters.RangedFilter=function(t,e){var n=new Array(t,e);return n.isFiltered=function(t){return t>=this[0]&&t<this[1]},n.filterType="RangedFilter",n},n.filters.TwoDimensionalFilter=function(t){if(null===t)return null;var e=t;return e.isFiltered=function(t){return t.length&&t.length===e.length&&t[0]===e[0]&&t[1]===e[1]},e.filterType="TwoDimensionalFilter",e},n.filters.RangedTwoDimensionalFilter=function(t){if(null===t)return null;var e,n=t;return e=n[0]instanceof Array?[[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1])],[Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]]:[[t[0],-1/0],[t[1],1/0]],n.isFiltered=function(t){var n,r;return t instanceof Array?(n=t[0],r=t[1]):(n=t,r=e[0][1]),n>=e[0][0]&&n<e[1][0]&&r>=e[0][1]&&r<e[1][1]},n.filterType="RangedTwoDimensionalFilter",n},n.filters.HierarchyFilter=function(t){if(null===t)return null;var e=t.slice(0);return e.isFiltered=function(t){if(!(e.length&&t&&t.length&&t.length>=e.length))return!1;for(var n=0;n<e.length;n++)if(t[n]!==e[n])return!1;return!0},e},n.baseMixin=function(r){var i,a,o,l,u,c;r.__dcFlag__=n.utils.uniqueId();var s,d,f,h,g,p=200,m=function(t){var e=t&&t.getBoundingClientRect&&t.getBoundingClientRect().width;return e&&e>p?e:p},y=m,v=200,x=function(t){var e=t&&t.getBoundingClientRect&&t.getBoundingClientRect().height;return e&&e>v?e:v},A=x,b=!1,w=n.pluck("key"),_=n.pluck("value"),k=n.pluck("key"),D=n.pluck("key"),L=!1,C=function(t){return r.keyAccessor()(t)+": "+r.valueAccessor()(t)},O=!0,E=!1,S=750,R=0,M=n.printers.filters,F=["dimension","group"],T=n.constants.DEFAULT_CHART_GROUP,B=t.dispatch("preRender","postRender","preRedraw","postRedraw","filtered","zoomed","renderlet","pretransition"),N=[],P=function(t,e){return 0===e.length?t.filter(null):1!==e.length||e[0].isFiltered?1===e.length&&"RangedFilter"===e[0].filterType?t.filterRange(e[0]):t.filterFunction((function(t){for(var n=0;n<e.length;n++){var r=e[n];if(r.isFiltered&&r.isFiltered(t))return!0;if(r<=t&&r>=t)return!0}return!1})):t.filterExact(e[0]),e},H=function(t){return t.all()};function G(){u&&(b?u.attr("viewBox")||u.attr("viewBox","0 0 "+r.width()+" "+r.height()):u.attr("width",r.width()).attr("height",r.height()))}function V(t){if(!r[t]||!r[t]())throw new n.errors.InvalidStateException("Mandatory attribute chart."+t+" is missing on chart[#"+r.anchorName()+"]")}r.height=function(t){return arguments.length?(A=t?"function"==typeof t?t:n.utils.constant(t):x,d=void 0,r):(n.utils.isNumber(d)||(d=A(l.node())),d)},r.width=function(t){return arguments.length?(y=t?"function"==typeof t?t:n.utils.constant(t):m,s=void 0,r):(n.utils.isNumber(s)||(s=y(l.node())),s)},r.minWidth=function(t){return arguments.length?(p=t,r):p},r.minHeight=function(t){return arguments.length?(v=t,r):v},r.useViewBoxResizing=function(t){return arguments.length?(b=t,r):b},r.dimension=function(t){return arguments.length?(i=t,r.expireCache(),r):i},r.data=function(t){return arguments.length?(H="function"==typeof t?t:n.utils.constant(t),r.expireCache(),r):H.call(r,a)},r.group=function(t,e){return arguments.length?(a=t,r._groupName=e,r.expireCache(),r):a},r.ordering=function(t){return arguments.length?(D=t,f=e.quicksort.by(D),r.expireCache(),r):D},r._computeOrderedGroups=function(t){var n=t.slice(0);return n.length<=1?n:(f||(f=e.quicksort.by(D)),f(n,0,n.length))},r.filterAll=function(){return r.filter(null)},r.select=function(t){return l.select(t)},r.selectAll=function(t){return l?l.selectAll(t):null},r.anchor=function(e,i){if(!arguments.length)return o;if(n.instanceOfChart(e))o=e.anchor(),l=e.root(),c=!0;else{if(!e)throw new n.errors.BadArgumentException("parent must be defined");o=e.select&&e.classed?e.node():e,(l=t.select(o)).classed(n.constants.CHART_CLASS,!0),n.registerChart(r,i),c=!1}return T=i,r},r.anchorName=function(){var t=r.anchor();return t&&t.id?t.id:t&&t.replace?t.replace("#",""):"dc-chart"+r.chartID()},r.root=function(t){return arguments.length?(l=t,r):l},r.svg=function(t){return arguments.length?(u=t,r):u},r.resetSvg=function(){return r.select("svg").remove(),u=r.root().append("svg"),G(),u},r.filterPrinter=function(t){return arguments.length?(M=t,r):M},r.controlsUseVisibility=function(t){return arguments.length?(E=t,r):E},r.turnOnControls=function(){if(l){var t=r.controlsUseVisibility()?"visibility":"display";r.selectAll(".reset").style(t,null),r.selectAll(".filter").text(M(r.filters())).style(t,null)}return r},r.turnOffControls=function(){if(l){var t=r.controlsUseVisibility()?"visibility":"display",e=r.controlsUseVisibility()?"hidden":"none";r.selectAll(".reset").style(t,e),r.selectAll(".filter").style(t,e).text(r.filter())}return r},r.transitionDuration=function(t){return arguments.length?(S=t,r):S},r.transitionDelay=function(t){return arguments.length?(R=t,r):R},r._mandatoryAttributes=function(t){return arguments.length?(F=t,r):F},r.render=function(){d=s=void 0,B.call("preRender",r,r),F&&F.forEach(V);var t=r._doRender();return h&&h.render(),r._activateRenderlets("postRender"),t},r._activateRenderlets=function(t){B.call("pretransition",r,r),r.transitionDuration()>0&&u?u.transition().duration(r.transitionDuration()).delay(r.transitionDelay()).on("end",(function(){B.call("renderlet",r,r),t&&B.call(t,r,r)})):(B.call("renderlet",r,r),t&&B.call(t,r,r))},r.redraw=function(){G(),B.call("preRedraw",r,r);var t=r._doRedraw();return h&&h.render(),r._activateRenderlets("postRedraw"),t},r.commitHandler=function(t){return arguments.length?(g=t,r):g},r.redrawGroup=function(){return g?g(!1,(function(t,e){t?console.log(t):n.redrawAll(r.chartGroup())})):n.redrawAll(r.chartGroup()),r},r.renderGroup=function(){return g?g(!1,(function(t,e){t?console.log(t):n.renderAll(r.chartGroup())})):n.renderAll(r.chartGroup()),r},r._invokeFilteredListener=function(t){void 0!==t&&B.call("filtered",r,r,t)},r._invokeZoomedListener=function(){B.call("zoomed",r,r)};var U=function(t,e){return null==e?t.length>0:t.some((function(t){return e<=t&&e>=t}))};r.hasFilterHandler=function(t){return arguments.length?(U=t,r):U},r.hasFilter=function(t){return U(N,t)};var z=function(t,e){for(var n=0;n<t.length;n++)if(t[n]<=e&&t[n]>=e){t.splice(n,1);break}return t};r.removeFilterHandler=function(t){return arguments.length?(z=t,r):z};var I=function(t,e){return t.push(e),t};r.addFilterHandler=function(t){return arguments.length?(I=t,r):I};var Y=function(t){return[]};return r.resetFilterHandler=function(t){return arguments.length?(Y=t,r):Y},r.replaceFilter=function(t){return N=Y(N),r.filter(t),r},r.filter=function(t){if(!arguments.length)return N.length>0?N[0]:null;var e=N;return t instanceof Array&&t[0]instanceof Array&&!t.isFiltered?t[0].forEach((function(t){e=U(e,t)?z(e,t):I(e,t)})):e=null===t?Y(e):U(e,t)?z(e,t):I(e,t),N=function(t){if(r.dimension()&&r.dimension().filter){var e=P(r.dimension(),t);e&&(t=e)}return t}(e),r._invokeFilteredListener(t),null!==l&&r.hasFilter()?r.turnOnControls():r.turnOffControls(),r},r.filters=function(){return N},r.highlightSelected=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!0),t.select(e).classed(n.constants.DESELECTED_CLASS,!1)},r.fadeDeselected=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!1),t.select(e).classed(n.constants.DESELECTED_CLASS,!0)},r.resetHighlight=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!1),t.select(e).classed(n.constants.DESELECTED_CLASS,!1)},r.onClick=function(t){var e=r.keyAccessor()(t);n.events.trigger((function(){r.filter(e),r.redrawGroup()}))},r.filterHandler=function(t){return arguments.length?(P=t,r):P},r._doRender=function(){return r},r._doRedraw=function(){return r},r.legendables=function(){return[]},r.legendHighlight=function(){},r.legendReset=function(){},r.legendToggle=function(){},r.isLegendableHidden=function(){return!1},r.keyAccessor=function(t){return arguments.length?(w=t,r):w},r.valueAccessor=function(t){return arguments.length?(_=t,r):_},r.label=function(t,e){return arguments.length?(k=t,(void 0===e||e)&&(L=!0),r):k},r.renderLabel=function(t){return arguments.length?(L=t,r):L},r.title=function(t){return arguments.length?(C=t,r):C},r.renderTitle=function(t){return arguments.length?(O=t,r):O},r.renderlet=n.logger.deprecate((function(t){return r.on("renderlet."+n.utils.uniqueId(),t),r}),'chart.renderlet has been deprecated.  Please use chart.on("renderlet.<renderletKey>", renderletFunction)'),r.chartGroup=function(t){return arguments.length?(c||n.deregisterChart(r,T),T=t,c||n.registerChart(r,T),r):T},r.expireCache=function(){return r},r.legend=function(t){return arguments.length?((h=t).parent(r),r):h},r.chartID=function(){return r.__dcFlag__},r.options=function(t){var e=["anchor","group","xAxisLabel","yAxisLabel","stack","title","point","getColor","overlayGeoJson"];for(var i in t)"function"==typeof r[i]?t[i]instanceof Array&&-1!==e.indexOf(i)?r[i].apply(r,t[i]):r[i].call(r,t[i]):n.logger.debug("Not a valid option setter name: "+i);return r},r.on=function(t,e){return B.on(t,e),r},r},n.marginMixin=function(t){var e={top:10,right:50,bottom:30,left:30};return t.margins=function(n){return arguments.length?(e=n,t):e},t.effectiveWidth=function(){return t.width()-t.margins().left-t.margins().right},t.effectiveHeight=function(){return t.height()-t.margins().top-t.margins().bottom},t},n.colorMixin=function(e){var r=t.scaleOrdinal(n.config.defaultColors()),i=!0,a=function(t){return e.keyAccessor()(t)};return e.colors=function(i){return arguments.length?(r=i instanceof Array?t.scaleQuantize().range(i):"function"==typeof i?i:n.utils.constant(i),e):r},e.ordinalColors=function(n){return e.colors(t.scaleOrdinal().range(n))},e.linearColors=function(n){return e.colors(t.scaleLinear().range(n).interpolate(t.interpolateHcl))},e.colorAccessor=function(t){return arguments.length?(a=t,i=!1,e):a},e.defaultColorAccessor=function(){return i},e.colorDomain=function(t){return arguments.length?(r.domain(t),e):r.domain()},e.calculateColorDomain=function(){var n=[t.min(e.data(),e.colorAccessor()),t.max(e.data(),e.colorAccessor())];return r.domain(n),e},e.getColor=function(t,e){return r(a.call(this,t,e))},e.colorCalculator=n.logger.deprecate((function(t){return arguments.length?(e.getColor=t,e):e.getColor}),"colorMixin.colorCalculator has been deprecated. Please colorMixin.colors and colorMixin.colorAccessor instead"),e},n.coordinateGridMixin=function(e){var r,i,a,o,l,u,c="grid-line",s="horizontal",d="vertical",f="y-axis-label",h="x-axis-label",g="custom-brush-handle";(e=n.colorMixin(n.marginMixin(n.baseMixin(e)))).colors(t.scaleOrdinal(t.schemeCategory10)),e._mandatoryAttributes().push("x");var p,m,y,v,x,A,b,w,_,k=t.axisBottom(),D=n.units.integers,L=0,C=t.timeDay,O=!1,E=0,S=null,R=0,M=!1,F=0,T=t.brushX(),B=!0,N=!1,P=!1,H=!1,G=!1,V=[1,1/0],U=!0,z=t.zoom().on("zoom",(function(){if(!t.event.sourceEvent)return;if(t.event.sourceEvent.type&&-1!==["start","zoom","end"].indexOf(t.event.sourceEvent.type))return;var n=t.event.transform.rescaleX(l).domain();e.focus(n,!1)})),I=t.zoom().on("zoom",null),Y=!1,j=!1,X=0,q=.5,W=0,K=!1;function Q(r,i){e.isOrdinal()?(o.bandwidth||(n.logger.warn("For compatibility with d3v4+, dc.js d3.0 ordinal bar/line/bubble charts need d3.scaleBand() for the x scale, instead of d3.scaleOrdinal(). Replacing .x() with a d3.scaleBand with the same domain - make the same change in your code to avoid this warning!"),o=t.scaleBand().domain(o.domain())),(e.elasticX()||0===o.domain().length)&&o.domain(e._ordinalXDomain())):e.elasticX()&&o.domain([e.xAxisMin(),e.xAxisMax()]);var a=o.domain();!i&&n.utils.arraysEqual(m,a)||e.rescale(),m=a,e.isOrdinal()?o.range([0,e.xAxisLength()]).paddingInner(W).paddingOuter(e._useOuterPadding()?q:0):o.range([0,e.xAxisLength()]),k=k.scale(e.x()),function(t){var r=t.select("g."+d);if(H){r.empty()&&(r=t.insert("g",":first-child").attr("class",c+" "+d).attr("transform","translate("+e.margins().left+","+e.margins().top+")"));var i=k.tickValues()?k.tickValues():"function"==typeof o.ticks?o.ticks.apply(o,k.tickArguments()):o.domain(),a=r.selectAll("line").data(i),l=a.enter().append("line").attr("x1",(function(t){return o(t)})).attr("y1",e._xAxisY()-e.margins().top).attr("x2",(function(t){return o(t)})).attr("y2",0).attr("opacity",0);n.transition(l,e.transitionDuration(),e.transitionDelay()).attr("opacity",1);var u=l.merge(a);n.transition(u,e.transitionDuration(),e.transitionDelay()).attr("x1",(function(t){return o(t)})).attr("y1",e._xAxisY()-e.margins().top).attr("x2",(function(t){return o(t)})).attr("y2",0),a.exit().remove()}else r.selectAll("line").remove()}(r)}function Z(){return K?t.axisRight():t.axisLeft()}function J(){return e.anchorName().replace(/[ .#=\[\]"]/g,"-")+"-clip"}function $(){var t=n.utils.appendOrSelect(r,"defs"),i=J(),a=n.utils.appendOrSelect(t,"#"+i,"clipPath").attr("id",i),o=2*X;n.utils.appendOrSelect(a,"rect").attr("width",e.xAxisLength()+o).attr("height",e.yAxisHeight()+o).attr("transform","translate(-"+X+", -"+X+")")}function tt(t){e.isOrdinal()&&(B=!1),Q(e.g(),t),e._prepareYAxis(e.g()),e.plotData(),(e.elasticX()||G||t)&&e.renderXAxis(e.g()),(e.elasticY()||G||t)&&e.renderYAxis(e.g()),t?e.renderBrush(e.g(),!1):e.redrawBrush(e.filter(),G),e.fadeDeselectedArea(e.filter()),G=!1}function et(t,r){var i,a;(a=t)instanceof Array&&a.length>1?(e.x().domain(t),i=n.filters.RangedFilter(t[0],t[1])):(e.x().domain(u),i=null),e.replaceFilter(i),e.rescale(),e.redraw(),r||(w&&!it(e.filter(),w.filter())&&n.events.trigger((function(){w.replaceFilter(i),w.redraw()})),e._invokeZoomedListener(),n.events.trigger((function(){e.redrawGroup()}),n.constants.EVENT_DELAY))}function nt(){var n,r,i,a,o;z&&z.transform(e.root(),(n=e.x().domain(),i=l,a=((r=u)[1]-r[0])/(n[1]-n[0]),o=-1*i(n[0]),t.zoomIdentity.scale(a).translate(o,0)))}function rt(t,e){return t&&2===t.length&&e&&2===e.length?((t[0]>e[1]||t[1]<e[0])&&console.warn("Could not intersect extents, will reset"),[t[0]>e[0]?t[0]:e[0],t[1]<e[1]?t[1]:e[1]]):t}function it(t,e){return!t&&!e||!(!t||!e)&&(0===t.length&&0===e.length||t[0].valueOf()===e[0].valueOf()&&t[1].valueOf()===e[1].valueOf())}return e.rescale=function(){return b=void 0,G=!0,e},e.resizing=function(){return G},e.rangeChart=function(t){return arguments.length?((w=t).focusChart(e),e):w},e.zoomScale=function(t){return arguments.length?(V=t,e):V},e.zoomOutRestrict=function(t){return arguments.length?(U=t,e):U},e._generateG=function(t){r=void 0===t?e.svg():t;var n=window.location.href.split("#")[0];return i=r.append("g"),a=i.append("g").attr("class","chart-body").attr("transform","translate("+e.margins().left+", "+e.margins().top+")").attr("clip-path","url("+n+"#"+J()+")"),i},e.g=function(t){return arguments.length?(i=t,e):i},e.mouseZoomable=function(t){return arguments.length?(j=t,e):j},e.chartBodyG=function(t){return arguments.length?(a=t,e):a},e.x=function(t){return arguments.length?(u=(o=t).domain(),e.rescale(),e):o},e.xOriginalDomain=function(){return u},e.xUnits=function(t){return arguments.length?(D=t,e):D},e.xAxis=function(t){return arguments.length?(k=t,e):k},e.elasticX=function(t){return arguments.length?(O=t,e):O},e.xAxisPadding=function(t){return arguments.length?(L=t,e):L},e.xAxisPaddingUnit=function(t){return arguments.length?(C=t,e):C},e.xUnitCount=function(){return void 0===b&&(e.isOrdinal()?b=e.x().domain().length:(b=e.xUnits()(e.x().domain()[0],e.x().domain()[1]))instanceof Array&&(b=b.length)),b},e.useRightYAxis=function(t){return arguments.length?(K!==t&&S&&n.logger.warn("Value of useRightYAxis has been altered, after yAxis was created. You might get unexpected yAxis behavior. Make calls to useRightYAxis sooner in your chart creation process."),K=t,e):K},e.isOrdinal=function(){return e.xUnits()===n.units.ordinal},e._useOuterPadding=function(){return!0},e._ordinalXDomain=function(){return e._computeOrderedGroups(e.data()).map(e.keyAccessor())},e.renderXAxis=function(t){var r=t.select("g.x");r.empty()&&(r=t.append("g").attr("class","axis x").attr("transform","translate("+e.margins().left+","+e._xAxisY()+")"));var i=t.select("text."+h);i.empty()&&e.xAxisLabel()&&(i=t.append("text").attr("class",h).attr("transform","translate("+(e.margins().left+e.xAxisLength()/2)+","+(e.height()-E)+")").attr("text-anchor","middle")),e.xAxisLabel()&&i.text()!==e.xAxisLabel()&&i.text(e.xAxisLabel()),n.transition(r,e.transitionDuration(),e.transitionDelay()).attr("transform","translate("+e.margins().left+","+e._xAxisY()+")").call(k),n.transition(i,e.transitionDuration(),e.transitionDelay()).attr("transform","translate("+(e.margins().left+e.xAxisLength()/2)+","+(e.height()-E)+")")},e._xAxisY=function(){return e.height()-e.margins().bottom},e.xAxisLength=function(){return e.effectiveWidth()},e.xAxisLabel=function(t,n){return arguments.length?(p=t,e.margins().bottom-=E,E=void 0===n?12:n,e.margins().bottom+=E,e):p},e._prepareYAxis=function(n){if(void 0===y||e.elasticY()){void 0===y&&(y=t.scaleLinear());var r=e.yAxisMin()||0,i=e.yAxisMax()||0;y.domain([r,i]).rangeRound([e.yAxisHeight(),0])}y.range([e.yAxisHeight(),0]),S||(S=Z()),S.scale(y),e._renderHorizontalGridLinesForAxis(n,y,S)},e.renderYAxisLabel=function(t,r,i,a){a=a||F;var o=e.g().select("text."+f+"."+t+"-label"),l=e.margins().top+e.yAxisHeight()/2;o.empty()&&r&&(o=e.g().append("text").attr("transform","translate("+a+","+l+"),rotate("+i+")").attr("class",f+" "+t+"-label").attr("text-anchor","middle").text(r)),r&&o.text()!==r&&o.text(r),n.transition(o,e.transitionDuration(),e.transitionDelay()).attr("transform","translate("+a+","+l+"),rotate("+i+")")},e.renderYAxisAt=function(t,r,i){var a=e.g().select("g."+t);a.empty()&&(a=e.g().append("g").attr("class","axis "+t).attr("transform","translate("+i+","+e.margins().top+")")),n.transition(a,e.transitionDuration(),e.transitionDelay()).attr("transform","translate("+i+","+e.margins().top+")").call(r)},e.renderYAxis=function(){var t=K?e.width()-e.margins().right:e._yAxisX();e.renderYAxisAt("y",S,t);var n=K?e.width()-F:F,r=K?90:-90;e.renderYAxisLabel("y",e.yAxisLabel(),r,n)},e._renderHorizontalGridLinesForAxis=function(t,r,i){var a=t.select("g."+s);if(P){var o=i.tickValues()?i.tickValues():r.ticks.apply(r,i.tickArguments());a.empty()&&(a=t.insert("g",":first-child").attr("class",c+" "+s).attr("transform","translate("+e.margins().left+","+e.margins().top+")"));var l=a.selectAll("line").data(o),u=l.enter().append("line").attr("x1",1).attr("y1",(function(t){return r(t)})).attr("x2",e.xAxisLength()).attr("y2",(function(t){return r(t)})).attr("opacity",0);n.transition(u,e.transitionDuration(),e.transitionDelay()).attr("opacity",1);var d=u.merge(l);n.transition(d,e.transitionDuration(),e.transitionDelay()).attr("x1",1).attr("y1",(function(t){return r(t)})).attr("x2",e.xAxisLength()).attr("y2",(function(t){return r(t)})),l.exit().remove()}else a.selectAll("line").remove()},e._yAxisX=function(){return e.useRightYAxis()?e.width()-e.margins().right:e.margins().left},e.yAxisLabel=function(t,n){return arguments.length?(v=t,e.margins().left-=F,F=void 0===n?12:n,e.margins().left+=F,e):v},e.y=function(t){return arguments.length?(y=t,e.rescale(),e):y},e.yAxis=function(t){return arguments.length?(S=t,e):(S||(S=Z()),S)},e.elasticY=function(t){return arguments.length?(M=t,e):M},e.renderHorizontalGridLines=function(t){return arguments.length?(P=t,e):P},e.renderVerticalGridLines=function(t){return arguments.length?(H=t,e):H},e.xAxisMin=function(){var r=t.min(e.data(),(function(t){return e.keyAccessor()(t)}));return n.utils.subtract(r,L,C)},e.xAxisMax=function(){var r=t.max(e.data(),(function(t){return e.keyAccessor()(t)}));return n.utils.add(r,L,C)},e.yAxisMin=function(){var r=t.min(e.data(),(function(t){return e.valueAccessor()(t)}));return n.utils.subtract(r,R)},e.yAxisMax=function(){var r=t.max(e.data(),(function(t){return e.valueAccessor()(t)}));return n.utils.add(r,R)},e.yAxisPadding=function(t){return arguments.length?(R=t,e):R},e.yAxisHeight=function(){return e.effectiveHeight()},e.round=function(t){return arguments.length?(A=t,e):A},e._rangeBandPadding=function(t){return arguments.length?(W=t,e):W},e._outerRangeBandPadding=function(t){return arguments.length?(q=t,e):q},n.override(e,"filter",(function(t){return arguments.length?(e._filter(t),e.redrawBrush(t,!1),e):e._filter()})),e.brush=function(t){return arguments.length?(T=t,e):T},e.renderBrush=function(t,n){B&&(T.on("start brush end",e._brushing),x=t.append("g").attr("class","brush").attr("transform","translate("+e.margins().left+","+e.margins().top+")"),e.setBrushExtents(),e.createBrushHandlePaths(x,n),e.redrawBrush(e.filter(),n))},e.createBrushHandlePaths=function(t){var n=t.selectAll("path."+g).data([{type:"w"},{type:"e"}]);(n=n.enter().append("path").attr("class",g).merge(n)).attr("d",e.resizeHandlePath)},e.extendBrush=function(t){return t&&e.round()&&(t[0]=e.round()(t[0]),t[1]=e.round()(t[1])),t},e.brushIsEmpty=function(t){return!t||t[1]<=t[0]},e._brushing=function(){if(t.event.sourceEvent&&(!t.event.sourceEvent.type||-1===["start","brush","end"].indexOf(t.event.sourceEvent.type))){var r=t.event.selection;r&&(r=r.map(e.x().invert)),r=e.extendBrush(r),e.redrawBrush(r,!1);var i=e.brushIsEmpty(r)?null:n.filters.RangedFilter(r[0],r[1]);n.events.trigger((function(){e.applyBrushSelection(i)}),n.constants.EVENT_DELAY)}},e.applyBrushSelection=function(t){e.replaceFilter(t),e.redrawGroup()},e.setBrushExtents=function(t){T.extent([[0,0],[e.effectiveWidth(),e.effectiveHeight()]]),x.call(T)},e.redrawBrush=function(t,r){if(B&&x)if(G&&e.setBrushExtents(r),t){var i=[o(t[0]),o(t[1])],a=n.optionalTransition(r,e.transitionDuration(),e.transitionDelay())(x);a.call(T.move,i),a.selectAll("path."+g).attr("display",null).attr("transform",(function(e,n){return"translate("+o(t[n])+", 0)"})).attr("d",e.resizeHandlePath)}else x.call(T.move,null),x.selectAll("path."+g).attr("display","none");e.fadeDeselectedArea(t)},e.fadeDeselectedArea=function(t){},e.resizeHandlePath=function(t){var n=+("e"===(t=t.type)),r=n?1:-1,i=e.effectiveHeight()/3;return"M"+.5*r+","+i+"A6,6 0 0 "+n+" "+6.5*r+","+(i+6)+"V"+(2*i-6)+"A6,6 0 0 "+n+" "+.5*r+","+2*i+"ZM"+2.5*r+","+(i+8)+"V"+(2*i-8)+"M"+4.5*r+","+(i+8)+"V"+(2*i-8)},e.clipPadding=function(t){return arguments.length?(X=t,e):X},e._preprocessData=function(){},e._doRender=function(){return e.resetSvg(),e._preprocessData(),e._generateG(),$(),tt(!0),l=o.copy(),j?e._enableMouseZoom():Y&&e._disableMouseZoom(),e},e._doRedraw=function(){return e._preprocessData(),tt(!1),$(),e},e._enableMouseZoom=function(){Y=!0;var t=[[0,0],[e.effectiveWidth(),e.effectiveHeight()]];if(z.scaleExtent(V).extent(t).duration(e.transitionDuration()),U){var n=Math.max(V[0],1);z.translateExtent(t).scaleExtent([n,V[1]])}e.root().call(z),nt()},e._disableMouseZoom=function(){e.root().call(I)},e.focus=function(t,e){U&&(t=rt(t,u),w&&(t=rt(t,w.x().domain()))),et(t,e),nt()},e.refocused=function(){return!it(e.x().domain(),u)},e.focusChart=function(t){return arguments.length?(_=t,e.on("filtered",(function(t){t.filter()?it(t.filter(),_.filter())||n.events.trigger((function(){_.focus(t.filter(),!0)})):n.events.trigger((function(){_.x().domain(_.xOriginalDomain(),!0)}))})),e):_},e.brushOn=function(t){return arguments.length?(B=t,e):B},e.parentBrushOn=function(t){return arguments.length?(N=t,e):N},e.gBrush=function(){return x},e},n.stackMixin=function(e){function r(t,r){var i=t.accessor||e.valueAccessor();t.name=String(t.name||r);var a=t.group.all().map((function(n,r){return{x:e.keyAccessor()(n,r),y:t.hidden?null:i(n,r),data:n,layer:t.name,hidden:t.hidden}}));t.domainValues=a.filter(function(){if(!e.x())return n.utils.constant(!0);var t=e.x().domain();if(e.isOrdinal())return function(){return!0};if(e.elasticX())return function(){return!0};return function(e){return e.x>=t[0]&&e.x<=t[t.length-1]}}()),t.values=e.evadeDomainFilter()?a:t.domainValues}var i=t.stack(),a=[],o={},l=!1,u=!1;function c(t){var e=a.map(n.pluck("name")).indexOf(t);return a[e]}function s(){var t=e.data().map((function(t){return t.domainValues}));return Array.prototype.concat.apply([],t)}function d(t){return!t.hidden}return e.stack=function(t,n,r){if(!arguments.length)return a;arguments.length<=2&&(r=n);var i={group:t};return"string"==typeof n&&(i.name=n),"function"==typeof r&&(i.accessor=r),a.push(i),e},n.override(e,"group",(function(t,n,r){return arguments.length?(a=[],o={},e.stack(t,n),r&&e.valueAccessor(r),e._group(t,n)):e._group()})),e.hidableStacks=function(t){return arguments.length?(l=t,e):l},e.hideStack=function(t){var n=c(t);return n&&(n.hidden=!0),e},e.showStack=function(t){var n=c(t);return n&&(n.hidden=!1),e},e.getValueAccessorByIndex=function(t){return a[t].accessor||e.valueAccessor()},e.yAxisMin=function(){var r=t.min(s(),(function(t){return t.y<0?t.y+t.y0:t.y0}));return n.utils.subtract(r,e.yAxisPadding())},e.yAxisMax=function(){var r=t.max(s(),(function(t){return t.y>0?t.y+t.y0:t.y0}));return n.utils.add(r,e.yAxisPadding())},e.xAxisMin=function(){var r=t.min(s(),n.pluck("x"));return n.utils.subtract(r,e.xAxisPadding(),e.xAxisPaddingUnit())},e.xAxisMax=function(){var r=t.max(s(),n.pluck("x"));return n.utils.add(r,e.xAxisPadding(),e.xAxisPaddingUnit())},n.override(e,"title",(function(t,n){return t?"function"==typeof t?e._title(t):t===e._groupName&&"function"==typeof n?e._title(n):"function"!=typeof n?o[t]||e._title():(o[t]=n,e):e._title()})),e.stackLayout=function(t){return arguments.length?(i=t,e):i},e.evadeDomainFilter=function(t){return arguments.length?(u=t,e):u},e.data((function(){var t=a.filter(d);if(!t.length)return[];t.forEach(r);var n=t[0].values.map((function(e,n){var r={x:e.x};return t.forEach((function(t){r[t.name]=t.values[n].y})),r})),i=t.map((function(t){return t.name}));return e.stackLayout().keys(i)(n).forEach((function(e,n){e.forEach((function(e,r){t[n].values[r].y0=e[0],t[n].values[r].y1=e[1]}))})),t})),e._ordinalXDomain=function(){var t=s().map(n.pluck("data"));return e._computeOrderedGroups(t).map(e.keyAccessor())},e.colorAccessor((function(t){return this.layer||this.name||t.name||t.layer})),e.legendables=function(){return a.map((function(t,n){return{chart:e,name:t.name,hidden:t.hidden||!1,color:e.getColor.call(t,t.values,n)}}))},e.isLegendableHidden=function(t){var e=c(t.name);return!!e&&e.hidden},e.legendToggle=function(t){l&&(e.isLegendableHidden(t)?e.showStack(t.name):e.hideStack(t.name),e.renderGroup())},e},n.capMixin=function(e){var r=1/0,i=!0,a="Others";e.ordering((function(t){return-t.value}));var o=function(n,r){var i=t.sum(r,e.valueAccessor()),a=r.map(e.keyAccessor());return i>0?n.concat([{others:a,key:e.othersLabel(),value:i}]):n};return e.cappedKeyAccessor=function(t,n){return t.others?t.key:e.keyAccessor()(t,n)},e.cappedValueAccessor=function(t,n){return t.others?t.value:e.valueAccessor()(t,n)},e.data((function(t){if(r===1/0)return e._computeOrderedGroups(t.all());var n,a=t.all();if(a=e._computeOrderedGroups(a),r)if(i)n=a.slice(r),a=a.slice(0,r);else{var l=Math.max(0,a.length-r);n=a.slice(0,l),a=a.slice(l)}return o?o(a,n):a})),e.cap=function(t){return arguments.length?(r=t,e):r},e.takeFront=function(t){return arguments.length?(i=t,e):i},e.othersLabel=function(t){return arguments.length?(a=t,e):a},e.othersGrouper=function(t){return arguments.length?(o=t,e):o},n.override(e,"onClick",(function(t){t.others&&e.filter([t.others]),e._onClick(t)})),e},n.bubbleMixin=function(e){var r=.3,i=10,a=!1,o=!1;e.BUBBLE_NODE_CLASS="node",e.BUBBLE_CLASS="bubble",e.MIN_RADIUS=10,(e=n.colorMixin(e)).renderLabel(!0),e.data((function(n){var r=n.all();if(a){var i=e.radiusValueAccessor();r.sort((function(e,n){return t.descending(i(e),i(n))}))}return r}));var l=t.scaleLinear().domain([0,100]),u=function(t){return t.r};e.r=function(t){return arguments.length?(l=t,e):l},e.elasticRadius=function(t){return arguments.length?(o=t,e):o},e.calculateRadiusDomain=function(){o&&e.r().domain([e.rMin(),e.rMax()])},e.radiusValueAccessor=function(t){return arguments.length?(u=t,e):u},e.rMin=function(){return t.min(e.data(),(function(t){return e.radiusValueAccessor()(t)}))},e.rMax=function(){return t.max(e.data(),(function(t){return e.radiusValueAccessor()(t)}))},e.bubbleR=function(t){var n=e.radiusValueAccessor()(t),r=e.r()(n);return(isNaN(r)||n<=0)&&(r=0),r};var c=function(t){return e.label()(t)},s=function(t){return e.bubbleR(t)>i},d=function(t){return s(t)?1:0},f=function(t){return s(t)?"all":"none"};e._doRenderLabel=function(t){if(e.renderLabel()){var r=t.select("text");r.empty()&&(r=t.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",e.onClick)),r.attr("opacity",0).attr("pointer-events",f).text(c),n.transition(r,e.transitionDuration(),e.transitionDelay()).attr("opacity",d)}},e.doUpdateLabels=function(t){if(e.renderLabel()){var r=t.select("text").attr("pointer-events",f).text(c);n.transition(r,e.transitionDuration(),e.transitionDelay()).attr("opacity",d)}};var h=function(t){return e.title()(t)};return e._doRenderTitles=function(t){e.renderTitle()&&(t.select("title").empty()&&t.append("title").text(h))},e.doUpdateTitles=function(t){e.renderTitle()&&t.select("title").text(h)},e.sortBubbleSize=function(t){return arguments.length?(a=t,e):a},e.minRadius=function(t){return arguments.length?(e.MIN_RADIUS=t,e):e.MIN_RADIUS},e.minRadiusWithLabel=function(t){return arguments.length?(i=t,e):i},e.maxBubbleRelativeSize=function(t){return arguments.length?(r=t,e):r},e.fadeDeselectedArea=function(t){e.hasFilter()?e.selectAll("g."+e.BUBBLE_NODE_CLASS).each((function(t){e.isSelectedNode(t)?e.highlightSelected(this):e.fadeDeselected(this)})):e.selectAll("g."+e.BUBBLE_NODE_CLASS).each((function(){e.resetHighlight(this)}))},e.isSelectedNode=function(t){return e.hasFilter(t.key)},e.onClick=function(t){var r=t.key;n.events.trigger((function(){e.filter(r),e.redrawGroup()}))},e},n.pieChart=function(e,r){var i,a,o,l,u,c,s="pie-slice",d="pie-label",f="pie-slice-group",h="pie-label-group",g="empty-chart",p="empty",m=0,y=0,v=.5,x=!1,A=n.capMixin(n.colorMixin(n.baseMixin({})));function b(){var e=t.min([A.width(),A.height()])/2;i=a&&a<e?a:e;var r,l=D(),u=t.pie().sort(null).value(A.cappedValueAccessor);if(t.sum(A.data(),A.valueAccessor())?(r=u(A.data()),o.classed(g,!1)):(r=u([{key:p,value:1,others:[p]}]),o.classed(g,!0)),o){var m=o.select("g."+f).selectAll("g."+s).data(r),y=o.select("g."+h).selectAll("text."+d).data(r);!function(t,e){t.exit().remove(),e.exit().remove()}(m,y),function(t,e,r,i){var a=function(t){var e=t.enter().append("g").attr("class",(function(t,e){return s+" _"+e}));return e}(t);(function(t,e){var r=t.append("path").attr("fill",O).on("click",E).attr("d",(function(t,n){return S(t,n,e)})),i=n.transition(r,A.transitionDuration(),A.transitionDelay());i.attrTween&&i.attrTween("d",C)})(a,r),function(t){A.renderTitle()&&t.append("title").text((function(t){return A.title()(t.data)}))}(a),function(t,e,n){if(A.renderLabel()){w(t.enter().append("text").attr("class",(function(t,e){var n=s+" "+d+" _"+e;return c&&(n+=" external"),n})).on("click",E).on("mouseover",(function(t,e){_(e,!0)})).on("mouseout",(function(t,e){_(e,!1)})),n),c&&x&&k(e,n)}}(e,i,r)}(m,y,l,r),function(t,e){(function(t,e){var r=o.selectAll("g."+s).data(t).select("path").attr("d",(function(t,n){return S(t,n,e)})),i=n.transition(r,A.transitionDuration(),A.transitionDelay());i.attrTween&&i.attrTween("d",C);i.attr("fill",O)})(t,e),function(t,e){if(A.renderLabel()){w(o.selectAll("text."+d).data(t),e),c&&x&&k(t,e)}}(t,e),function(t){A.renderTitle()&&o.selectAll("g."+s).data(t).select("title").text((function(t){return A.title()(t.data)}))}(t)}(r,l),A.hasFilter()?A.selectAll("g."+s).each((function(t){L(t)?A.highlightSelected(this):A.fadeDeselected(this)})):A.selectAll("g."+s).each((function(){A.resetHighlight(this)})),n.transition(o,A.transitionDuration(),A.transitionDelay()).attr("transform","translate("+A.cx()+","+A.cy()+")")}}function w(e,r){A._applyLabelText(e),n.transition(e,A.transitionDuration(),A.transitionDelay()).attr("transform",(function(e){return function(e,n){var r;r=c?t.arc().outerRadius(i-y+c).innerRadius(i-y+c).centroid(e):n.centroid(e);return isNaN(r[0])||isNaN(r[1])?"translate(0,0)":"translate("+r+")"}(e,r)})).attr("text-anchor","middle")}function _(t,e){A.select("g.pie-slice._"+t).classed("highlight",e)}function k(e,r){var a=o.selectAll("polyline."+s).data(e);a.exit().remove(),a=a.enter().append("polyline").attr("class",(function(t,e){return"pie-path _"+e+" "+s})).on("click",E).on("mouseover",(function(t,e){_(e,!0)})).on("mouseout",(function(t,e){_(e,!1)})).merge(a);var l=t.arc().outerRadius(i-y+c).innerRadius(i-y),u=n.transition(a,A.transitionDuration(),A.transitionDelay());u.attrTween?u.attrTween("points",(function(e){var n=this._current||e;n={startAngle:n.startAngle,endAngle:n.endAngle};var i=t.interpolate(n,e);return this._current=i(0),function(t){var e=i(t);return[r.centroid(e),l.centroid(e)]}})):u.attr("points",(function(t){return[r.centroid(t),l.centroid(t)]})),u.style("visibility",(function(t){return t.endAngle-t.startAngle<1e-4?"hidden":"visible"}))}function D(){return t.arc().outerRadius(i-y).innerRadius(m)}function L(t){return A.hasFilter(A.cappedKeyAccessor(t.data))}function C(e){e.innerRadius=m;var n=this._current;n=function(t){return!t||isNaN(t.startAngle)||isNaN(t.endAngle)}(n)?{startAngle:0,endAngle:0}:{startAngle:n.startAngle,endAngle:n.endAngle};var r=t.interpolate(n,e);return this._current=r(0),function(t){return S(r(t),0,D())}}function O(t,e){return A.getColor(t.data,e)}function E(t,e){o.attr("class")!==g&&A.onClick(t.data,e)}function S(t,e,n){var r=n(t,e);return r.indexOf("NaN")>=0&&(r="M0,0"),r}function R(e,n){A.selectAll("g.pie-slice").each((function(r){e.name===r.data.key&&t.select(this).classed("highlight",n)}))}return A.colorAccessor(A.cappedKeyAccessor),A.title((function(t){return A.cappedKeyAccessor(t)+": "+A.cappedValueAccessor(t)})),A.slicesCap=A.cap,A.label(A.cappedKeyAccessor),A.renderLabel(!0),A.transitionDuration(350),A.transitionDelay(0),A._doRender=function(){return A.resetSvg(),(o=A.svg().append("g").attr("transform","translate("+A.cx()+","+A.cy()+")")).append("g").attr("class",f),o.append("g").attr("class",h),b(),A},A._applyLabelText=function(t){t.text((function(t){return!function(t){return 0===A.cappedValueAccessor(t)}(t.data)&&!function(t){var e=t.endAngle-t.startAngle;return isNaN(e)||e<v}(t)||L(t)?A.label()(t.data):""}))},A.externalRadiusPadding=function(t){return arguments.length?(y=t,A):y},A.innerRadius=function(t){return arguments.length?(m=t,A):m},A.radius=function(t){return arguments.length?(a=t,A):a},A.cx=function(t){return arguments.length?(l=t,A):l||A.width()/2},A.cy=function(t){return arguments.length?(u=t,A):u||A.height()/2},A._doRedraw=function(){return b(),A},A.minAngleForLabel=function(t){return arguments.length?(v=t,A):v},A.emptyTitle=function(t){return 0===arguments.length?p:(p=t,A)},A.externalLabels=function(t){return 0===arguments.length?c:(c=t||void 0,A)},A.drawPaths=function(t){return 0===arguments.length?x:(x=t,A)},A.legendables=function(){return A.data().map((function(t,e){var n={name:t.key,data:t.value,others:t.others,chart:A};return n.color=A.getColor(t,e),n}))},A.legendHighlight=function(t){R(t,!0)},A.legendReset=function(t){R(t,!1)},A.legendToggle=function(t){A.onClick({key:t.name,others:t.others})},A.anchor(e,r)},n.sunburstChart=function(e,r){var i,a,o,l,u,c="pie-slice",s="empty-chart",d="empty",f=0,h=.5,g=n.capMixin(n.colorMixin(n.baseMixin({})));function p(){i=i||t.min([g.width(),g.height()])/2;var e,r=y();if(t.sum(g.data(),g.valueAccessor())?((e=v(n.utils.toHierarchy(g.data(),g.valueAccessor()))).shift(),a.classed(s,!1)):(e=v(n.utils.toHierarchy([],(function(t){return t.value}))),a.classed(s,!0)),a){var o=a.selectAll("g."+c).data(e);!function(t,e,r){var i=function(t){var e=t.enter().append("g").attr("class",(function(t,e){return c+" _"+e+" "+c+"-level-"+t.depth}));return e}(t);(function(t,e){var r=t.append("path").attr("fill",A).on("click",w).attr("d",(function(t,n){return _(t,n,e)})),i=n.transition(r,g.transitionDuration());i.attrTween&&i.attrTween("d",x)})(i,e),function(t){g.renderTitle()&&t.append("title").text((function(t){return g.title()(t)}))}(i),function(t,e){if(g.renderLabel()){var n=a.selectAll("text."+c).data(t);n.exit().remove(),m(n.enter().append("text").attr("class",(function(t,e){var n=c+" _"+e;return u&&(n+=" external"),n})).on("click",w),e)}}(r,e)}(o,r,e),function(t,e){(function(t,e){var r=a.selectAll("g."+c).data(t).select("path").attr("d",(function(t,n){return _(t,n,e)})),i=n.transition(r,g.transitionDuration());i.attrTween&&i.attrTween("d",x);i.attr("fill",A)})(t,e),function(t,e){if(g.renderLabel()){m(a.selectAll("text."+c).data(t),e)}}(t,e),function(t){g.renderTitle()&&a.selectAll("g."+c).data(t).select("title").text((function(t){return g.title()(t)}))}(t)}(e,r),function(t){t.exit().remove()}(o),g.hasFilter()?g.selectAll("g."+c).each((function(t){!function(t){return function(t){for(var e=0;e<g.filters().length;e++)if(g.filters()[e].isFiltered(t))return!0;return!1}(t.path)}(t)?g.fadeDeselected(this):g.highlightSelected(this)})):g.selectAll("g."+c).each((function(t){g.resetHighlight(this)}))}}function m(e,r){n.transition(e,g.transitionDuration()).attr("transform",(function(e){return function(e,n){var r;r=u?t.svg.arc().outerRadius(i+u).innerRadius(i+u).centroid(e):n.centroid(e);return isNaN(r[0])||isNaN(r[1])?"translate(0,0)":"translate("+r+")"}(e,r)})).attr("text-anchor","middle").text((function(t){return function(t){return 0===g.cappedValueAccessor(t)}(t)||function(t){var e=t.x1-t.x0;return isNaN(e)||e<h}(t)?"":g.label()(t)}))}function y(){return t.arc().startAngle((function(t){return t.x0})).endAngle((function(t){return t.x1})).innerRadius((function(t){return t.data.path&&1===t.data.path.length?f:Math.sqrt(t.y0)})).outerRadius((function(t){return Math.sqrt(t.y1)}))}function v(e){var n=t.hierarchy(e).sum((function(t){return t.children?0:g.cappedValueAccessor(t)})).sort((function(e,n){return t.ascending(e.data.path,n.data.path)}));return t.partition().size([2*Math.PI,i*i])(n),n.descendants().map((function(t){return t.key=t.data.key,t.path=t.data.path,t}))}function x(e){e.innerRadius=f;var n=this._current;(function(t){return!t||isNaN(t.dx)||isNaN(t.dy)})(n)&&(n={x:0,y:0,dx:0,dy:0});var r={x:e.x,y:e.y,dx:e.dx,dy:e.dy},i=t.interpolate(n,r);return this._current=i(0),function(t){return _(Object.assign({},e,i(t)),0,y())}}function A(t,e){return g.getColor(t,e)}function b(t){for(var e=t.path||t.key,r=n.filters.HierarchyFilter(e),i=function(t){for(var e=n.filters.HierarchyFilter(t),r=[],i=0;i<g.filters().length;i++){var a=g.filters()[i];(a.isFiltered(t)||e.isFiltered(a))&&r.push(a)}return r}(e),a=!1,o=i.length-1;o>=0;o--){var l=i[o];n.utils.arraysIdentical(l,e)&&(a=!0),g.filter(i[o])}n.events.trigger((function(){a||g.filter(r),g.redrawGroup()}))}function w(t,e){a.attr("class")!==s&&b(t)}function _(t,e,n){var r=n(t,e);return r.indexOf("NaN")>=0&&(r="M0,0"),r}function k(e,n){g.selectAll("g.pie-slice").each((function(r){e.name===r.key&&t.select(this).classed("highlight",n)}))}return g.colorAccessor(g.cappedKeyAccessor),g.title((function(t){return g.cappedKeyAccessor(t)+": "+g.cappedValueAccessor(t)})),g.label(g.cappedKeyAccessor),g.renderLabel(!0),g.transitionDuration(350),g.filterHandler((function(t,e){return 0===e.length?t.filter(null):t.filterFunction((function(t){for(var n=0;n<e.length;n++){var r=e[n];if(r.isFiltered&&r.isFiltered(t))return!0}return!1})),e})),g._doRender=function(){return g.resetSvg(),a=g.svg().append("g").attr("transform","translate("+g.cx()+","+g.cy()+")"),p(),g},g.innerRadius=function(t){return arguments.length?(f=t,g):f},g.radius=function(t){return arguments.length?(i=t,g):i},g.cx=function(t){return arguments.length?(o=t,g):o||g.width()/2},g.cy=function(t){return arguments.length?(l=t,g):l||g.height()/2},g.minAngleForLabel=function(t){return arguments.length?(h=t,g):h},g.emptyTitle=function(t){return 0===arguments.length?d:(d=t,g)},g.externalLabels=function(t){return 0===arguments.length?u:(u=t||void 0,g)},g._doRedraw=function(){return p(),g},g.onClick=w,g.legendables=function(){return g.data().map((function(t,e){var n={name:t.key,data:t.value,others:t.others,chart:g};return n.color=g.getColor(t,e),n}))},g.legendHighlight=function(t){k(t,!0)},g.legendReset=function(t){k(t,!1)},g.legendToggle=function(t){g.onClick({key:t.name,others:t.others})},g.anchor(e,r)},n.barChart=function(e,r){var i,a=3,o=n.stackMixin(n.coordinateGridMixin({})),l=2,u=!1,c=!1;function s(t){return n.utils.safeNumber(Math.abs(o.y()(t.y+t.y0)-o.y()(t.y0)))}function d(t){var e=o.x()(t.x);return u||(e+=i/2),o.isOrdinal()&&void 0!==l&&(e+=l/2),n.utils.safeNumber(e)}function f(t){var e=o.y()(t.y+t.y0);return t.y<0&&(e-=s(t)),n.utils.safeNumber(e-a)}function h(t){var e=o.x()(t.x);return u&&(e-=i/2),o.isOrdinal()&&void 0!==l&&(e+=l/2),n.utils.safeNumber(e)}function g(e,n){return function(){var r=t.select(this).attr("fill")===e;return n?!r:r}}return n.override(o,"rescale",(function(){return o._rescale(),i=void 0,o})),n.override(o,"render",(function(){return o.round()&&u&&!c&&n.logger.warn("By default, brush rounding is disabled if bars are centered. See dc.js bar chart API documentation for details."),o._render()})),o.label((function(t){return n.utils.printSingleValue(t.y0+t.y)}),!1),o.plotData=function(){var e=o.chartBodyG().selectAll("g.stack").data(o.data());!function(){if(void 0===i){var t=o.xUnitCount();((i=o.isOrdinal()&&void 0===l?Math.floor(o.x().bandwidth()):l?Math.floor((o.xAxisLength()-(t-1)*l)/t):Math.floor(o.xAxisLength()/(1+o.barPadding())/t))===1/0||isNaN(i)||i<1)&&(i=1)}}();var r=(e=e.enter().append("g").attr("class",(function(t,e){return"stack _"+e})).merge(e)).size()-1;e.each((function(e,a){var l=t.select(this);!function(t,e,r){var a=t.selectAll("rect.bar").data(r.values,n.pluck("x")),l=a.enter().append("rect").attr("class","bar").attr("fill",n.pluck("data",o.getColor)).attr("x",h).attr("y",o.yAxisHeight()).attr("height",0),u=l.merge(a);o.renderTitle()&&l.append("title").text(n.pluck("data",o.title(r.name)));o.isOrdinal()&&u.on("click",o.onClick);n.transition(u,o.transitionDuration(),o.transitionDelay()).attr("x",h).attr("y",(function(t){var e=o.y()(t.y+t.y0);return t.y<0&&(e-=s(t)),n.utils.safeNumber(e)})).attr("width",i).attr("height",(function(t){return s(t)})).attr("fill",n.pluck("data",o.getColor)).select("title").text(n.pluck("data",o.title(r.name))),n.transition(a.exit(),o.transitionDuration(),o.transitionDelay()).attr("x",(function(t){return o.x()(t.x)})).attr("width",.9*i).remove()}(l,0,e),o.renderLabel()&&r===a&&function(t,e,r){var i=t.selectAll("text.barLabel").data(r.values,n.pluck("x")),a=i.enter().append("text").attr("class","barLabel").attr("text-anchor","middle").attr("x",d).attr("y",f).merge(i);o.isOrdinal()&&(a.on("click",o.onClick),a.attr("cursor","pointer"));n.transition(a,o.transitionDuration(),o.transitionDelay()).attr("x",d).attr("y",f).text((function(t){return o.label()(t)})),n.transition(i.exit(),o.transitionDuration(),o.transitionDelay()).attr("height",0).remove()}(l,0,e)}))},o.fadeDeselectedArea=function(t){var e=o.chartBodyG().selectAll("rect.bar");if(o.isOrdinal())o.hasFilter()?(e.classed(n.constants.SELECTED_CLASS,(function(t){return o.hasFilter(t.x)})),e.classed(n.constants.DESELECTED_CLASS,(function(t){return!o.hasFilter(t.x)}))):(e.classed(n.constants.SELECTED_CLASS,!1),e.classed(n.constants.DESELECTED_CLASS,!1));else if(o.brushOn()||o.parentBrushOn())if(o.brushIsEmpty(t))e.classed(n.constants.DESELECTED_CLASS,!1);else{var r=t[0],i=t[1];e.classed(n.constants.DESELECTED_CLASS,(function(t){return t.x<r||t.x>=i}))}},o.centerBar=function(t){return arguments.length?(u=t,o):u},n.override(o,"onClick",(function(t){o._onClick(t.data)})),o.barPadding=function(t){return arguments.length?(o._rangeBandPadding(t),l=void 0,o):o._rangeBandPadding()},o._useOuterPadding=function(){return void 0===l},o.outerPadding=o._outerRangeBandPadding,o.gap=function(t){return arguments.length?(l=t,o):l},o.extendBrush=function(t){return t&&o.round()&&(!u||c)&&(t[0]=o.round()(t[0]),t[1]=o.round()(t[1])),t},o.alwaysUseRounding=function(t){return arguments.length?(c=t,o):c},o.legendHighlight=function(t){o.isLegendableHidden(t)||o.g().selectAll("rect.bar").classed("highlight",g(t.color)).classed("fadeout",g(t.color,!0))},o.legendReset=function(){o.g().selectAll("rect.bar").classed("highlight",!1).classed("fadeout",!1)},n.override(o,"xAxisMax",(function(){var t=this._xAxisMax();"resolution"in o.xUnits()&&(t+=o.xUnits().resolution);return t})),o.anchor(e,r)},n.lineChart=function(e,r){var i,a,o="dc-tooltip",l="dot",u="yRef",c="xRef",s=1e-6,d=n.stackMixin(n.coordinateGridMixin({})),f=!1,h=5,g=null,p=s,m=s,y=null,v=null,x=null,A=!0;function b(t,e){return d.getColor.call(t,t.values,e)}function w(){var e=null;if(y)return y;"function"==typeof v?e=v:e={linear:t.curveLinear,"linear-closed":t.curveLinearClosed,step:t.curveStep,"step-before":t.curveStepBefore,"step-after":t.curveStepAfter,basis:t.curveBasis,"basis-open":t.curveBasisOpen,"basis-closed":t.curveBasisClosed,bundle:t.curveBundle,cardinal:t.curveCardinal,"cardinal-open":t.curveCardinalOpen,"cardinal-closed":t.curveCardinalClosed,monotone:t.curveMonotoneX}[v];return e||(e=t.curveLinear),null!==x&&("function"!=typeof e.tension?n.logger.warn("tension was specified but the curve/interpolate does not support it."):e=e.tension(x)),e}function _(t){return!t||t.indexOf("NaN")>=0?"M0,0":t}function k(){return g||h}function D(t,e){d.renderTitle()&&(t.select("title").remove(),t.append("title").text(n.pluck("data",d.title(e.name))))}function L(e,n,r){return function(){var i=t.select(this),a=i.attr("stroke")===e&&i.attr("stroke-dasharray")===(n instanceof Array?n.join(","):null)||i.attr("fill")===e;return r?!a:a}}return d.transitionDuration(500),d.transitionDelay(0),d._rangeBandPadding(1),d.plotData=function(){var e=d.chartBodyG(),r=e.select("g.stack-list");r.empty()&&(r=e.append("g").attr("class","stack-list"));var s=r.selectAll("g.stack").data(d.data()),g=s.enter().append("g").attr("class",(function(t,e){return"stack _"+e}));s=g.merge(s),function(e,r){var o=t.line().x((function(t){return d.x()(t.x)})).y((function(t){return d.y()(t.y+t.y0)})).curve(w());i&&o.defined(i);var l=e.append("path").attr("class","line").attr("stroke",b);a&&l.attr("stroke-dasharray",a);n.transition(r.select("path.line"),d.transitionDuration(),d.transitionDelay()).attr("stroke",b).attr("d",(function(t){return _(o(t.values))}))}(g,s),function(e,r){if(f){var a=t.area().x((function(t){return d.x()(t.x)})).y1((function(t){return d.y()(t.y+t.y0)})).y0((function(t){return d.y()(t.y0)})).curve(w());i&&a.defined(i),e.append("path").attr("class","area").attr("fill",b).attr("d",(function(t){return _(a(t.values))})),n.transition(r.select("path.area"),d.transitionDuration(),d.transitionDelay()).attr("fill",b).attr("d",(function(t){return _(a(t.values))}))}}(g,s),function(e,r){if("always"===d.xyTipsOn()||!d.brushOn()&&!d.parentBrushOn()&&d.xyTipsOn()){var a=o+"-list",s=e.select("g."+a);s.empty()&&(s=e.append("g").attr("class",a)),r.each((function(e,r){var a=e.values;i&&(a=a.filter(i));var f=s.select("g."+o+"._"+r);f.empty()&&(f=s.append("g").attr("class",o+" _"+r)),function(t){var e=t.select("path."+u).empty()?t.append("path").attr("class",u):t.select("path."+u);e.style("display","none").attr("stroke-dasharray","5,5");var n=t.select("path."+c).empty()?t.append("path").attr("class",c):t.select("path."+c);n.style("display","none").attr("stroke-dasharray","5,5")}(f);var g=f.selectAll("circle."+l).data(a,n.pluck("x")),y=g.enter().append("circle").attr("class",l).attr("cx",(function(t){return n.utils.safeNumber(d.x()(t.x))})).attr("cy",(function(t){return n.utils.safeNumber(d.y()(t.y+t.y0))})).attr("r",k()).style("fill-opacity",p).style("stroke-opacity",m).attr("fill",d.getColor).on("mousemove",(function(){var e=t.select(this);!function(t){t.style("fill-opacity",.8),t.style("stroke-opacity",.8),t.attr("r",h)}(e),function(t,e){var n=t.attr("cx"),r=t.attr("cy"),i="M"+(d._yAxisX()-d.margins().left)+" "+r+"L"+n+" "+r,a="M"+n+" "+d.yAxisHeight()+"L"+n+" "+r;e.select("path."+u).style("display","").attr("d",i),e.select("path."+c).style("display","").attr("d",a)}(e,f)})).on("mouseout",(function(){!function(t){t.style("fill-opacity",p).style("stroke-opacity",m).attr("r",k())}(t.select(this)),function(t){t.select("path."+u).style("display","none"),t.select("path."+c).style("display","none")}(f)})).merge(g);y.call(D,e),n.transition(y,d.transitionDuration()).attr("cx",(function(t){return n.utils.safeNumber(d.x()(t.x))})).attr("cy",(function(t){return n.utils.safeNumber(d.y()(t.y+t.y0))})).attr("fill",d.getColor),g.exit().remove()}))}}(e,s),d.renderLabel()&&function(e){e.each((function(e,r){var i=t.select(this).selectAll("text.lineLabel").data(e.values,n.pluck("x")),a=i.enter().append("text").attr("class","lineLabel").attr("text-anchor","middle").merge(i);n.transition(a,d.transitionDuration()).attr("x",(function(t){return n.utils.safeNumber(d.x()(t.x))})).attr("y",(function(t){var e=d.y()(t.y+t.y0)-3;return n.utils.safeNumber(e)})).text((function(t){return d.label()(t)})),n.transition(i.exit(),d.transitionDuration()).attr("height",0).remove()}))}(s)},d.curve=function(t){return arguments.length?(y=t,d):y},d.interpolate=n.logger.deprecate((function(t){return arguments.length?(v=t,d):v}),"dc.lineChart.interpolate has been deprecated since version 3.0 use dc.lineChart.curve instead"),d.tension=n.logger.deprecate((function(t){return arguments.length?(x=t,d):x}),"dc.lineChart.tension has been deprecated since version 3.0 use dc.lineChart.curve instead"),d.defined=function(t){return arguments.length?(i=t,d):i},d.dashStyle=function(t){return arguments.length?(a=t,d):a},d.renderArea=function(t){return arguments.length?(f=t,d):f},d.label((function(t){return n.utils.printSingleValue(t.y0+t.y)}),!1),d.xyTipsOn=function(t){return arguments.length?(A=t,d):A},d.dotRadius=function(t){return arguments.length?(h=t,d):h},d.renderDataPoints=function(t){return arguments.length?(t?(p=t.fillOpacity||.8,m=t.strokeOpacity||.8,g=t.radius||2):(p=s,m=s,g=null),d):{fillOpacity:p,strokeOpacity:m,radius:g}},d.legendHighlight=function(t){d.isLegendableHidden(t)||d.g().selectAll("path.line, path.area").classed("highlight",L(t.color,t.dashstyle)).classed("fadeout",L(t.color,t.dashstyle,!0))},d.legendReset=function(){d.g().selectAll("path.line, path.area").classed("highlight",!1).classed("fadeout",!1)},n.override(d,"legendables",(function(){var t=d._legendables();return a?t.map((function(t){return t.dashstyle=a,t})):t})),d.anchor(e,r)},n.dataCount=function(e,r){var i=t.format(",d"),a=n.baseMixin({}),o={some:"",all:""};return a.html=function(t){return arguments.length?(t.all&&(o.all=t.all),t.some&&(o.some=t.some),a):o},a.formatNumber=function(t){return arguments.length?(i=t,a):i},a._doRender=function(){var t=a.dimension().size(),e=a.group().value(),n=i(t),r=i(e);return t===e&&""!==o.all?a.root().html(o.all.replace("%total-count",n).replace("%filter-count",r)):""!==o.some?a.root().html(o.some.replace("%total-count",n).replace("%filter-count",r)):(a.selectAll(".total-count").text(n),a.selectAll(".filter-count").text(r)),a},a._doRedraw=function(){return a._doRender()},a.anchor(e,r)},n.dataTable=function(e,r){var i,a="dc-table-label",o="dc-table-row",l="dc-table-column",u="dc-table-group",c="dc-table-head",s=n.baseMixin({}),d=25,f=[],h=function(t){return t},g=t.ascending,p=0,m=!0;return s._doRender=function(){var e,n,r;return s.selectAll("tbody").remove(),e=function(){var e=!0;if(f.forEach((function(t){e&="function"==typeof t})),!e){var n=s.selectAll("thead").data([0]);n.exit().remove();var r=(n=n.enter().append("thead").merge(n)).selectAll("tr").data([0]);r.exit().remove();var o=(r=r.enter().append("tr").merge(r)).selectAll("th").data(f);o.exit().remove(),o.enter().append("th").merge(o).attr("class",c).html((function(t){return s._doColumnHeaderFormat(t)}))}var l,y=s.root().selectAll("tbody").data((l=g===t.ascending?s.dimension().bottom(d):s.dimension().top(d),t.nest().key(s.group()).sortKeys(g).entries(l.sort((function(t,e){return g(h(t),h(e))})).slice(p,i))),(function(t){return s.keyAccessor()(t)})),v=y.enter().append("tbody");return!0===m&&v.append("tr").attr("class",u).append("td").attr("class",a).attr("colspan",f.length).html((function(t){return s.keyAccessor()(t)})),y.exit().remove(),v}(),n=e.order().selectAll("tr."+o).data((function(t){return t.values})),r=n.enter().append("tr").attr("class",o),f.forEach((function(t,e){r.append("td").attr("class",l+" _"+e).html((function(e){return s._doColumnValueFormat(t,e)}))})),n.exit().remove(),s},s._doColumnValueFormat=function(t,e){return"function"==typeof t?t(e):"string"==typeof t?e[t]:t.format(e)},s._doColumnHeaderFormat=function(t){return"function"==typeof t?s._doColumnHeaderFnToString(t):"string"==typeof t?s._doColumnHeaderCapitalize(t):String(t.label)},s._doColumnHeaderCapitalize=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},s._doColumnHeaderFnToString=function(t){var e=String(t),n=e.indexOf("return ");if(n>=0){var r=e.lastIndexOf(";");if(r>=0)(e=e.substring(n+7,r)).indexOf("numberFormat")>=0&&(e=e.replace("numberFormat",""))}return e},s._doRedraw=function(){return s._doRender()},s.size=function(t){return arguments.length?(d=t,s):d},s.beginSlice=function(t){return arguments.length?(p=t,s):p},s.endSlice=function(t){return arguments.length?(i=t,s):i},s.columns=function(t){return arguments.length?(f=t,s):f},s.sortBy=function(t){return arguments.length?(h=t,s):h},s.order=function(t){return arguments.length?(g=t,s):g},s.showGroups=function(t){return arguments.length?(m=t,s):m},s.anchor(e,r)},n.dataGrid=function(e,r){var i,a="dc-grid-item",o="dc-grid-top",l=n.baseMixin({}),u=999,c=function(t){return"you need to provide an html() handling param:  "+JSON.stringify(t)},s=function(t){return t},d=t.ascending,f=0,h=function(t){return"<div class='dc-grid-group'><h1 class='dc-grid-label'>"+l.keyAccessor()(t)+"</h1></div>"};return l._doRender=function(){var e,n;return l.selectAll("div."+o).remove(),e=function(){var e,n=l.root().selectAll("div."+o).data((e=l.dimension().top(u),t.nest().key(l.group()).sortKeys(d).entries(e.sort((function(t,e){return d(s(t),s(e))})).slice(f,i))),(function(t){return l.keyAccessor()(t)})),r=n.enter().append("div").attr("class",o);return h&&r.html((function(t){return h(t)})),n.exit().remove(),r}(),(n=e.order().selectAll("div."+a).data((function(t){return t.values}))).exit().remove(),n=n.enter().append("div").attr("class",a).html((function(t){return c(t)})).merge(n),l},l._doRedraw=function(){return l._doRender()},l.beginSlice=function(t){return arguments.length?(f=t,l):f},l.endSlice=function(t){return arguments.length?(i=t,l):i},l.size=function(t){return arguments.length?(u=t,l):u},l.html=function(t){return arguments.length?(c=t,l):c},l.htmlGroup=function(t){return arguments.length?(h=t,l):h},l.sortBy=function(t){return arguments.length?(s=t,l):s},l.order=function(t){return arguments.length?(d=t,l):d},l.anchor(e,r)},n.bubbleChart=function(t,e){var r=n.bubbleMixin(n.coordinateGridMixin({}));r.transitionDuration(750),r.transitionDelay(0);var i=function(t){return"translate("+function(t){var e=r.x()(r.keyAccessor()(t));!isNaN(e)&&isFinite(e)||(e=0);return e}(t)+","+function(t){var e=r.y()(r.valueAccessor()(t));!isNaN(e)&&isFinite(e)||(e=0);return e}(t)+")"};return r.plotData=function(){r.calculateRadiusDomain(),r.r().range([r.MIN_RADIUS,r.xAxisLength()*r.maxBubbleRelativeSize()]);var t=r.data(),e=r.chartBodyG().selectAll("g."+r.BUBBLE_NODE_CLASS).data(t,(function(t){return t.key}));r.sortBubbleSize()&&e.order(),function(t){n.transition(t,r.transitionDuration(),r.transitionDelay()).attr("transform",i).select("circle."+r.BUBBLE_CLASS).attr("fill",r.getColor).attr("r",(function(t){return r.bubbleR(t)})).attr("opacity",(function(t){return r.bubbleR(t)>0?1:0})),r.doUpdateLabels(t),r.doUpdateTitles(t)}(e=function(t){var e=t.enter().append("g");return e.attr("class",r.BUBBLE_NODE_CLASS).attr("transform",i).append("circle").attr("class",(function(t,e){return r.BUBBLE_CLASS+" _"+e})).on("click",r.onClick).attr("fill",r.getColor).attr("r",0),t=e.merge(t),n.transition(t,r.transitionDuration(),r.transitionDelay()).select("circle."+r.BUBBLE_CLASS).attr("r",(function(t){return r.bubbleR(t)})).attr("opacity",(function(t){return r.bubbleR(t)>0?1:0})),r._doRenderLabel(e),r._doRenderTitles(e),t}(e)),function(t){t.exit().remove()}(e),r.fadeDeselectedArea(r.filter())},r.renderBrush=function(){},r.redrawBrush=function(t,e){r.fadeDeselectedArea(t)},r.anchor(t,e)},n.compositeChart=function(e,r){var i,a=n.coordinateGridMixin({}),o=[],l={},u=!1,c=!0,s=!1,d=t.axisRight(),f=0,h=12,g=!1;function p(t,e){t._generateG(a.g()),t.g().attr("class","sub _"+e)}function m(){return o.filter((function(t){return!t.useRightYAxis()}))}function y(){return o.filter((function(t){return t.useRightYAxis()}))}function v(t){return t.map((function(t){return t.yAxisMin()}))}function x(t){return t.map((function(t){return t.yAxisMax()}))}return a._mandatoryAttributes([]),a.transitionDuration(500),a.transitionDelay(0),n.override(a,"_generateG",(function(){for(var t=this.__generateG(),e=0;e<o.length;++e){var n=o[e];p(n,e),n.dimension()||n.dimension(a.dimension()),n.group()||n.group(a.group()),n.chartGroup(a.chartGroup()),n.svg(a.svg()),n.xUnits(a.xUnits()),n.transitionDuration(a.transitionDuration(),a.transitionDelay()),n.parentBrushOn(a.brushOn()),n.brushOn(!1),n.renderTitle(a.renderTitle()),n.elasticX(a.elasticX())}return t})),a.applyBrushSelection=function(t){a.replaceFilter(t);for(var e=0;e<o.length;++e)o[e].replaceFilter(t);a.redrawGroup()},a._prepareYAxis=function(){var e=0!==m().length,r=0!==y().length,o=function(e,r){var i,o,l,u,c;e&&(i=t.min(v(m())),o=n.utils.add(t.max(x(m())),a.yAxisPadding()));r&&(l=t.min(v(y())),u=n.utils.add(t.max(x(y())),a.yAxisPadding()));a.alignYAxes()&&e&&r&&(c=function(t,e,n,r){var i=(r-n)/(e-t);return{lyAxisMin:Math.min(t,n/i),lyAxisMax:Math.max(e,r/i),ryAxisMin:Math.min(n,t*i),ryAxisMax:Math.max(r,e*i)}}(i,o,l,u));return c||{lyAxisMin:i,lyAxisMax:o,ryAxisMin:l,ryAxisMax:u}}(e,r);e&&function(e){var n=void 0===a.y()||a.elasticY(),r=n||a.resizing();void 0===a.y()&&a.y(t.scaleLinear());n&&a.y().domain([e.lyAxisMin,e.lyAxisMax]);r&&a.y().rangeRound([a.yAxisHeight(),0]);a.y().range([a.yAxisHeight(),0]),a.yAxis(a.yAxis().scale(a.y()))}(o),r&&function(e){var n=void 0===a.rightY()||a.elasticY(),r=n||a.resizing();void 0===a.rightY()&&a.rightY(t.scaleLinear());n&&a.rightY().domain([e.ryAxisMin,e.ryAxisMax]);r&&a.rightY().rangeRound([a.yAxisHeight(),0]);a.rightY().range([a.yAxisHeight(),0]),a.rightYAxis(a.rightYAxis().scale(a.rightY()))}(o),m().length>0&&!g?a._renderHorizontalGridLinesForAxis(a.g(),a.y(),a.yAxis()):y().length>0&&a._renderHorizontalGridLinesForAxis(a.g(),i,d)},a.renderYAxis=function(){0!==m().length&&(a.renderYAxisAt("y",a.yAxis(),a.margins().left),a.renderYAxisLabel("y",a.yAxisLabel(),-90)),0!==y().length&&(a.renderYAxisAt("yr",a.rightYAxis(),a.width()-a.margins().right),a.renderYAxisLabel("yr",a.rightYAxisLabel(),90,a.width()-h))},a.plotData=function(){for(var t=0;t<o.length;++t){var e=o[t];e.g()||p(e,t),u&&e.colors(a.colors()),e.x(a.x()),e.xAxis(a.xAxis()),e.useRightYAxis()?(e.y(a.rightY()),e.yAxis(a.rightYAxis())):(e.y(a.y()),e.yAxis(a.yAxis())),e.plotData(),e._activateRenderlets()}},a.useRightAxisGridLines=function(t){return arguments?(g=t,a):g},a.childOptions=function(t){return arguments.length?(l=t,o.forEach((function(t){t.options(l)})),a):l},a.fadeDeselectedArea=function(t){if(a.brushOn())for(var e=0;e<o.length;++e){o[e].fadeDeselectedArea(t)}},a.rightYAxisLabel=function(t,e){return arguments.length?(f=t,a.margins().right-=h,h=void 0===e?12:e,a.margins().right+=h,a):f},a.compose=function(t){return(o=t).forEach((function(t){t.height(a.height()),t.width(a.width()),t.margins(a.margins()),c&&t.title(a.title()),t.options(l)})),a},a.children=function(){return o},a.shareColors=function(t){return arguments.length?(u=t,a):u},a.shareTitle=function(t){return arguments.length?(c=t,a):c},a.rightY=function(t){return arguments.length?(i=t,a.rescale(),a):i},a.alignYAxes=function(t){return arguments.length?(s=t,a.rescale(),a):s},delete a.yAxisMin,delete a.yAxisMax,n.override(a,"xAxisMin",(function(){return n.utils.subtract(t.min(o.map((function(t){return t.xAxisMin()}))),a.xAxisPadding(),a.xAxisPaddingUnit())})),n.override(a,"xAxisMax",(function(){return n.utils.add(t.max(o.map((function(t){return t.xAxisMax()}))),a.xAxisPadding(),a.xAxisPaddingUnit())})),a.legendables=function(){return o.reduce((function(t,e){return u&&e.colors(a.colors()),t.push.apply(t,e.legendables()),t}),[])},a.legendHighlight=function(t){for(var e=0;e<o.length;++e){o[e].legendHighlight(t)}},a.legendReset=function(t){for(var e=0;e<o.length;++e){o[e].legendReset(t)}},a.legendToggle=function(){console.log("composite should not be getting legendToggle itself")},a.rightYAxis=function(t){return arguments.length?(d=t,a):d},a.anchor(e,r)},n.seriesChart=function(e,r){var i=n.compositeChart(e,r);var a,o={},l=n.lineChart,u=t.ascending,c=function(e,n){return t.ascending(i.keyAccessor()(e),i.keyAccessor()(n))};function s(t){o[t].g()&&o[t].g().remove(),delete o[t]}function d(){Object.keys(o).map(s),o={}}return i._mandatoryAttributes().push("seriesAccessor","chart"),i.shareColors(!0),i._preprocessData=function(){var e,d=[],f=t.nest().key(a);u&&f.sortKeys(u),c&&f.sortValues(c);var h=f.entries(i.data()).map((function(t,a){var u=o[t.key]||l.call(i,i,r,t.key,a);return o[t.key]||(e=!0),o[t.key]=u,d.push(t.key),u.dimension(i.dimension()).group({all:"function"==typeof t.values?t.values:n.utils.constant(t.values)},t.key).keyAccessor(i.keyAccessor()).valueAccessor(i.valueAccessor()).brushOn(!1)}));Object.keys(o).filter((function(t){return-1===d.indexOf(t)})).forEach((function(t){s(t),e=!0})),i._compose(h),e&&i.legend()&&i.legend().render()},i.chart=function(t){return arguments.length?(l=t,d(),i):l},i.seriesAccessor=function(t){return arguments.length?(a=t,d(),i):a},i.seriesSort=function(t){return arguments.length?(u=t,d(),i):u},i.valueSort=function(t){return arguments.length?(c=t,d(),i):c},i._compose=i.compose,delete i.compose,i},n.geoChoroplethChart=function(e,r){var i=n.colorMixin(n.baseMixin({}));i.colorAccessor((function(t){return t||0}));var a,o,l=t.geoPath(),u=[];function c(e){var r=function(){for(var t={},e=i.data(),n=0;n<e.length;++n)t[i.keyAccessor()(e[n])]=i.valueAccessor()(e[n]);return t}();if(function(t){return h(t).keyAccessor}(e)){var a=function(t){var e=i.svg().selectAll(function(t){return"g.layer"+t+" g."+h(t).name}(t)).classed("selected",(function(e){return s(t,e)})).classed("deselected",(function(e){return d(t,e)})).attr("class",(function(e){var r=h(t).name+" "+n.utils.nameToId(h(t).keyAccessor(e));return s(t,e)&&(r+=" selected"),d(t,e)&&(r+=" deselected"),r}));return e}(e);!function(e,r,a){var o=e.select("path").attr("fill",(function(){var e=t.select(this).attr("fill");return e||"none"})).on("click",(function(t){return i.onClick(t,r)}));n.transition(o,i.transitionDuration(),i.transitionDelay()).attr("fill",(function(t,e){return i.getColor(a[h(r).keyAccessor(t)],e)}))}(a,e,r),function(t,e,n){i.renderTitle()&&t.selectAll("title").text((function(t){var r=f(e,t),a=n[r];return i.title()({key:r,value:a})}))}(a,e,r)}}function s(t,e){return i.hasFilter()&&i.hasFilter(f(t,e))}function d(t,e){return i.hasFilter()&&!i.hasFilter(f(t,e))}function f(t,e){return h(t).keyAccessor(e)}function h(t){return u[t]}i._doRender=function(){i.resetSvg();for(var t=0;t<u.length;++t){var e=i.svg().append("g").attr("class","layer"+t).selectAll("g."+h(t).name).data(h(t).data);(e=e.enter().append("g").attr("class",h(t).name).merge(e)).append("path").attr("fill","white").attr("d",g()),e.append("title"),c(t)}a=!1},i.onClick=function(t,e){var r=h(e).keyAccessor(t);n.events.trigger((function(){i.filter(r),i.redrawGroup()}))},i._doRedraw=function(){for(var t=0;t<u.length;++t)c(t),a&&i.svg().selectAll("g."+h(t).name+" path").attr("d",g());a=!1},i.overlayGeoJson=function(t,e,n){for(var r=0;r<u.length;++r)if(u[r].name===e)return u[r].data=t,u[r].keyAccessor=n,i;return u.push({name:e,data:t,keyAccessor:n}),i},i.projection=function(t){return arguments.length?(o=t,a=!0,i):o};var g=function(){return void 0===o?(n.logger.warn("choropleth projection default of geoAlbers is deprecated, in next version projection will need to be set explicitly"),l.projection(t.geoAlbersUsa())):l.projection(o)};return i.geoJsons=function(){return u},i.geoPath=function(){return l},i.removeGeoJson=function(t){for(var e=[],n=0;n<u.length;++n){var r=u[n];r.name!==t&&e.push(r)}return u=e,i},i.anchor(e,r)},n.bubbleOverlay=function(e,r){var i,a="bubble-overlay",o="node",l="bubble",u=n.bubbleMixin(n.baseMixin({})),c=[];function s(){var t={};return u.data().forEach((function(e){t[u.keyAccessor()(e)]=e})),t}function d(t,e){var r=o+" "+n.utils.nameToId(t.name),a=i.select("g."+n.utils.nameToId(t.name));return a.empty()&&(a=i.append("g").attr("class",r).attr("transform","translate("+t.x+","+t.y+")")),a.datum(e[t.name]),a}return u.transitionDuration(750),u.transitionDelay(0),u.radiusValueAccessor((function(t){return t.value})),u.point=function(t,e,n){return c.push({name:t,x:e,y:n}),u},u._doRender=function(){var t;return i=function(){(i=u.select("g."+a)).empty()&&(i=u.svg().append("g").attr("class",a));return i}(),u.r().range([u.MIN_RADIUS,u.width()*u.maxBubbleRelativeSize()]),t=s(),u.calculateRadiusDomain(),c.forEach((function(e){var r=d(e,t),i=r.select("circle."+l);i.empty()&&(i=r.append("circle").attr("class",l).attr("r",0).attr("fill",u.getColor).on("click",u.onClick)),n.transition(i,u.transitionDuration(),u.transitionDelay()).attr("r",(function(t){return u.bubbleR(t)})),u._doRenderLabel(r),u._doRenderTitles(r)})),u.fadeDeselectedArea(u.filter()),u},u._doRedraw=function(){var t;return t=s(),u.calculateRadiusDomain(),c.forEach((function(e){var r=d(e,t),i=r.select("circle."+l);n.transition(i,u.transitionDuration(),u.transitionDelay()).attr("r",(function(t){return u.bubbleR(t)})).attr("fill",u.getColor),u.doUpdateLabels(r),u.doUpdateTitles(r)})),u.fadeDeselectedArea(u.filter()),u},u.debug=function(e){if(e){var r=u.select("g."+n.constants.DEBUG_GROUP_CLASS);r.empty()&&(r=u.svg().append("g").attr("class",n.constants.DEBUG_GROUP_CLASS));var i=r.append("text").attr("x",10).attr("y",20);r.append("rect").attr("width",u.width()).attr("height",u.height()).on("mousemove",(function(){var e=t.mouse(r.node()),n=e[0]+", "+e[1];i.text(n)}))}else u.selectAll(".debug").remove();return u},u.anchor(e,r),u},n.rowChart=function(e,r){var i,a,o,l,u=10,c=15,s=!1,d="0.35em",f=2,h=5,g=!1,p="row",m="titlerow",y=!1,v=n.capMixin(n.marginMixin(n.colorMixin(n.baseMixin({})))),x=t.axisBottom();function A(){var e=i.select("g.axis");!function(){if(!a||o){var e=t.extent(l,v.cappedValueAccessor);e[0]>0&&(e[0]=0),e[1]<0&&(e[1]=0),a=t.scaleLinear().domain(e).range([0,v.effectiveWidth()])}x.scale(a)}(),e.empty()&&(e=i.append("g").attr("class","axis")),e.attr("transform","translate(0, "+v.effectiveHeight()+")"),n.transition(e,v.transitionDuration(),v.transitionDelay()).call(x)}function b(){l=v.data(),A(),i.selectAll("g.tick").select("line.grid-line").remove(),i.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",(function(){return-v.effectiveHeight()}));var t=i.selectAll("g."+p).data(l);!function(t){t.exit().remove()}(t),function(t){var e,r=l.length;e=g||(v.effectiveHeight()-(r+1)*h)/r;s||(c=e/2);var i=t.attr("transform",(function(t,n){return"translate(0,"+((n+1)*h+n*e)+")"})).select("rect").attr("height",e).attr("fill",v.getColor).on("click",_).classed("deselected",(function(t){return!!v.hasFilter()&&!D(t)})).classed("selected",(function(t){return!!v.hasFilter()&&D(t)}));n.transition(i,v.transitionDuration(),v.transitionDelay()).attr("width",(function(t){return Math.abs(w()-a(v.valueAccessor()(t)))})).attr("transform",k),function(t){v.renderTitle()&&(t.select("title").remove(),t.append("title").text(v.title()))}(t),function(t){if(v.renderLabel()){var e=t.select("text").attr("x",u).attr("y",c).attr("dy",d).on("click",_).attr("class",(function(t,e){return p+" _"+e})).text((function(t){return v.label()(t)}));n.transition(e,v.transitionDuration(),v.transitionDelay()).attr("transform",k)}if(v.renderTitleLabel()){var r=t.select("."+m).attr("x",v.effectiveWidth()-f).attr("y",c).attr("dy",d).attr("text-anchor","end").on("click",_).attr("class",(function(t,e){return m+" _"+e})).text((function(t){return v.title()(t)}));n.transition(r,v.transitionDuration(),v.transitionDelay()).attr("transform",k)}}(t)}(t=function(t){var e=t.enter().append("g").attr("class",(function(t,e){return p+" _"+e}));return e.append("rect").attr("width",0),function(t){v.renderLabel()&&t.append("text").on("click",_);v.renderTitleLabel()&&t.append("text").attr("class",m).on("click",_)}(e),e}(t).merge(t))}function w(){var t=a(0);return t===-1/0||t!=t?a(1):t}function _(t){v.onClick(t)}function k(t){var e=a(v.cappedValueAccessor(t)),n=w();return"translate("+(e>n?n:e)+",0)"}function D(t){return v.hasFilter(v.cappedKeyAccessor(t))}return v.rowsCap=v.cap,v._doRender=function(){return v.resetSvg(),i=v.svg().append("g").attr("transform","translate("+v.margins().left+","+v.margins().top+")"),b(),v},v.title((function(t){return v.cappedKeyAccessor(t)+": "+v.cappedValueAccessor(t)})),v.label(v.cappedKeyAccessor),v.x=function(t){return arguments.length?(a=t,v):a},v.renderTitleLabel=function(t){return arguments.length?(y=t,v):y},v._doRedraw=function(){return b(),v},v.xAxis=function(t){return arguments.length?(x=t,this):x},v.fixedBarHeight=function(t){return arguments.length?(g=t,v):g},v.gap=function(t){return arguments.length?(h=t,v):h},v.elasticX=function(t){return arguments.length?(o=t,v):o},v.labelOffsetX=function(t){return arguments.length?(u=t,v):u},v.labelOffsetY=function(t){return arguments.length?(c=t,s=!0,v):c},v.titleLabelOffsetX=function(t){return arguments.length?(f=t,v):f},v.anchor(e,r)},n.legend=function(){var t,e,r,i={},a=0,o=0,l=12,u=5,c=!1,s=560,d=70,f=!1,h=n.pluck("name");function g(){return u+l}return i.parent=function(e){return arguments.length?(t=e,i):t},i.render=function(){t.svg().select("g.dc-legend").remove(),r=t.svg().append("g").attr("class","dc-legend").attr("transform","translate("+a+","+o+")");var i=t.legendables();void 0!==e&&(i=i.slice(0,e));var p=r.selectAll("g.dc-legend-item").data(i).enter().append("g").attr("class","dc-legend-item").on("mouseover",(function(e){t.legendHighlight(e)})).on("mouseout",(function(e){t.legendReset(e)})).on("click",(function(t){t.chart.legendToggle(t)}));r.selectAll("g.dc-legend-item").classed("fadeout",(function(t){return t.chart.isLegendableHidden(t)})),i.some(n.pluck("dashstyle"))?p.append("line").attr("x1",0).attr("y1",l/2).attr("x2",l).attr("y2",l/2).attr("stroke-width",2).attr("stroke-dasharray",n.pluck("dashstyle")).attr("stroke",n.pluck("color")):p.append("rect").attr("width",l).attr("height",l).attr("fill",(function(t){return t?t.color:"blue"})),p.append("text").text(h).attr("x",l+2).attr("y",(function(){return l/2+(this.clientHeight?this.clientHeight:13)/2-2}));var m=0,y=0;p.attr("transform",(function(t,e){if(c){var n=!0===f?this.getBBox().width+u:d;m+n>s&&m>0&&(++y,m=0);var r="translate("+m+","+y*g()+")";return m+=n,r}return"translate(0,"+e*g()+")"}))},i.x=function(t){return arguments.length?(a=t,i):a},i.y=function(t){return arguments.length?(o=t,i):o},i.gap=function(t){return arguments.length?(u=t,i):u},i.itemHeight=function(t){return arguments.length?(l=t,i):l},i.horizontal=function(t){return arguments.length?(c=t,i):c},i.legendWidth=function(t){return arguments.length?(s=t,i):s},i.itemWidth=function(t){return arguments.length?(d=t,i):d},i.autoItemWidth=function(t){return arguments.length?(f=t,i):f},i.legendText=function(t){return arguments.length?(h=t,i):h},i.maxItems=function(t){return arguments.length?(e=n.utils.isNumber(t)?t:void 0,i):e},i},n.htmlLegend=function(){var e,r,i,a,o={},l=n.pluck("name"),u=!1,c=!1;return o.parent=function(t){return arguments.length?(e=t,o):e},o.render=function(){var t=u?"dc-legend-item-horizontal":"dc-legend-item-vertical";r.select("div.dc-html-legend").remove();var o=r.append("div").attr("class","dc-html-legend");o.attr("style","max-width:"+r.nodes()[0].style.width);var s=e.legendables(),d=e.filters();void 0!==i&&(s=s.slice(0,i));var f=a||t,h=o.selectAll("div."+f).data(s).enter().append("div").classed(f,!0).on("mouseover",e.legendHighlight).on("mouseout",e.legendReset).on("click",e.legendToggle);c&&h.classed(n.constants.SELECTED_CLASS,(function(t){return-1!==d.indexOf(t.name)})),h.append("span").attr("class","dc-legend-item-color").style("background-color",n.pluck("color")),h.append("span").attr("class","dc-legend-item-label").attr("title",l).text(l)},o.container=function(e){return arguments.length?(r=t.select(e),o):r},o.legendItemClass=function(t){return arguments.length?(a=t,o):a},o.highlightSelected=function(t){return arguments.length?(c=t,o):c},o.horizontal=function(t){return arguments.length?(u=t,o):u},o.legendText=function(t){return arguments.length?(l=t,o):l},o.maxItems=function(t){return arguments.length?(i=n.utils.isNumber(t)?t:void 0,o):i},o},n.scatterPlot=function(e,r){var i=n.coordinateGridMixin({}),a=t.symbol(),o=function(t){return t.value},l=i.keyAccessor();i.keyAccessor((function(t){return l(t)[0]})),i.valueAccessor((function(t){return l(t)[1]})),i.colorAccessor((function(){return i._groupName})),i.title((function(t){return i.keyAccessor()(t)+","+i.valueAccessor()(t)+": "+i.existenceAccessor()(t)}));var u=function(t){return"translate("+i.x()(i.keyAccessor()(t))+","+i.y()(i.valueAccessor()(t))+")"},c=7,s=5,d=3,f=null,h=1,g=0,p=0,m=1,y=null,v=[];function x(t,e){return o(t)?v[e]?Math.pow(s,2):Math.pow(d,2):Math.pow(g,2)}function A(t,e){i.renderTitle()&&(t.selectAll("title").remove(),t.append("title").text((function(t){return i.title()(t)})))}function b(e,r){var o=i.chartBodyG().selectAll(".chart-body path.symbol").filter((function(){return e(t.select(this))})),l=a.size();a.size(Math.pow(r,2)),n.transition(o,i.transitionDuration(),i.transitionDelay()).attr("d",a),a.size(l)}return i.brush(t.brush()),a.size(x),n.override(i,"_filter",(function(t){return arguments.length?i.__filter(n.filters.RangedTwoDimensionalFilter(t)):i.__filter()})),i.plotData=function(){var t=i.chartBodyG().selectAll("path.symbol").data(i.data());(t=t.enter().append("path").attr("class","symbol").attr("opacity",0).attr("fill",i.getColor).attr("transform",u).merge(t)).call(A,i.data()),t.each((function(t,e){v[e]=!i.filter()||i.filter().isFiltered([i.keyAccessor()(t),i.valueAccessor()(t)])})),n.transition(t,i.transitionDuration(),i.transitionDelay()).attr("opacity",(function(t,e){return o(t)?v[e]?m:i.excludedOpacity():p})).attr("fill",(function(t,e){return y&&!o(t)?y:i.excludedColor()&&!v[e]?i.excludedColor():i.getColor(t)})).attr("transform",u).attr("d",a),n.transition(t.exit(),i.transitionDuration(),i.transitionDelay()).attr("opacity",0).remove()},i.existenceAccessor=function(t){return arguments.length?(o=t,this):o},i.symbol=function(t){return arguments.length?(a.type(t),i):a.type()},i.customSymbol=function(t){return arguments.length?((a=t).size(x),i):a},i.symbolSize=function(t){return arguments.length?(s=t,i):s},i.highlightedSize=function(t){return arguments.length?(c=t,i):c},i.excludedSize=function(t){return arguments.length?(d=t,i):d},i.excludedColor=function(t){return arguments.length?(f=t,i):f},i.excludedOpacity=function(t){return arguments.length?(h=t,i):h},i.hiddenSize=i.emptySize=function(t){return arguments.length?(g=t,i):g},i.emptyColor=function(t){return arguments.length?(y=t,i):y},i.emptyOpacity=function(t){return arguments.length?(p=t,i):p},i.nonemptyOpacity=function(t){return arguments.length?(m=t,i):p},i.legendables=function(){return[{chart:i,name:i._groupName,color:i.getColor()}]},i.legendHighlight=function(e){b((function(t){return t.attr("fill")===e.color}),c),i.chartBodyG().selectAll(".chart-body path.symbol").filter((function(){return t.select(this).attr("fill")!==e.color})).classed("fadeout",!0)},i.legendReset=function(e){b((function(t){return t.attr("fill")===e.color}),s),i.chartBodyG().selectAll(".chart-body path.symbol").filter((function(){return t.select(this).attr("fill")!==e.color})).classed("fadeout",!1)},i.createBrushHandlePaths=function(){},i.extendBrush=function(t){return i.round()&&(t[0]=t[0].map(i.round()),t[1]=t[1].map(i.round())),t},i.brushIsEmpty=function(t){return!t||t[0][0]>=t[1][0]||t[0][1]>=t[1][1]},i._brushing=function(){if(t.event.sourceEvent&&(!t.event.sourceEvent.type||-1===["start","brush","end"].indexOf(t.event.sourceEvent.type))){var e=t.event.selection,r=i.brushIsEmpty(e);e&&(e=e.map((function(t){return t.map((function(t,e){return(0===e?i.x():i.y()).invert(t)}))})),e=i.extendBrush(e),r=r&&i.brushIsEmpty(e)),i.redrawBrush(e,!1);var a=r?null:n.filters.RangedTwoDimensionalFilter(e);n.events.trigger((function(){i.replaceFilter(a),i.redrawGroup()}),n.constants.EVENT_DELAY)}},i.redrawBrush=function(t,e){var r=i.brush(),a=i.gBrush();i.brushOn()&&a&&(i.resizing()&&i.setBrushExtents(e),t?(t=t.map((function(t){return t.map((function(t,e){return(0===e?i.x():i.y())(t)}))})),n.optionalTransition(e,i.transitionDuration(),i.transitionDelay())(a).call(r.move,t)):a.call(r.move,t));i.fadeDeselectedArea(t)},i.setBrushY=function(t){t.call(i.brush().y(i.y()))},i.anchor(e,r)},n.numberDisplay=function(e,r){var i,a="number-display",o=t.format(".2s"),l=n.baseMixin({}),u={one:"",some:"",none:""};return l._mandatoryAttributes(["group"]),l.ordering((function(t){return t.value})),l.html=function(t){return arguments.length?(t.none?u.none=t.none:t.one?u.none=t.one:t.some&&(u.none=t.some),t.one?u.one=t.one:t.some&&(u.one=t.some),t.some?u.some=t.some:t.one&&(u.some=t.one),l):u},l.value=function(){return l.data()},l.data((function(t){var e=t.value?t.value():function(t){if(!t.length)return null;var e=l._computeOrderedGroups(t);return e[e.length-1]}(t.all());return l.valueAccessor()(e)})),l.transitionDuration(250),l.transitionDelay(0),l._doRender=function(){var e=l.value(),n=l.selectAll("."+a);n.empty()&&(n=n.data([0]).enter().append("span").attr("class",a).merge(n)),n.transition().duration(l.transitionDuration()).delay(l.transitionDelay()).ease(t.easeQuad).tween("text",(function(){var n=isFinite(i)?i:0,r=t.interpolateNumber(n||0,e);i=e;var a=this;return function(t){var n=null,i=l.formatNumber()(r(t));0===e&&""!==u.none?n=u.none:1===e&&""!==u.one?n=u.one:""!==u.some&&(n=u.some),a.innerHTML=n?n.replace("%number",i):i}}))},l._doRedraw=function(){return l._doRender()},l.formatNumber=function(t){return arguments.length?(o=t,l):o},l.anchor(e,r)},n.heatMap=function(e,r){var i,a,o,l=t.ascending,u=t.ascending,c=t.scaleBand(),s=t.scaleBand(),d=6.75,f=6.75,h=n.colorMixin(n.marginMixin(n.baseMixin({})));h._mandatoryAttributes(["group"]),h.title(h.colorAccessor());var g=function(t){return t},p=function(t){return t};h.colsLabel=function(t){return arguments.length?(g=t,h):g},h.rowsLabel=function(t){return arguments.length?(p=t,h):p};var m=function(t){x(0,t)},y=function(t){x(1,t)},v=function(t){var e=t.key;n.events.trigger((function(){h.filter(e),h.redrawGroup()}))};function x(t,e){var r=h.selectAll(".box-group").filter((function(n){return n.key[t]===e})),i=r.filter((function(t){return!h.hasFilter(t.key)}));n.events.trigger((function(){var t=(i.empty()?r:i).data().map((function(t){return n.filters.TwoDimensionalFilter(t.key)}));h._filter([t]),h.redrawGroup()}))}return n.override(h,"filter",(function(t){return arguments.length?h._filter(n.filters.TwoDimensionalFilter(t)):h._filter()})),h.rows=function(t){return arguments.length?(o=t,h):o},h.rowOrdering=function(t){return arguments.length?(u=t,h):u},h.cols=function(t){return arguments.length?(a=t,h):a},h.colOrdering=function(t){return arguments.length?(l=t,h):l},h._doRender=function(){return h.resetSvg(),i=h.svg().append("g").attr("class","heatmap").attr("transform","translate("+h.margins().left+","+h.margins().top+")"),h._doRedraw()},h._doRedraw=function(){var t=h.data(),e=h.rows()||t.map(h.valueAccessor()),r=h.cols()||t.map(h.keyAccessor());u&&(e=e.sort(u)),l&&(r=r.sort(l)),e=s.domain(e),r=c.domain(r);var a=e.domain().length,o=r.domain().length,g=Math.floor(h.effectiveWidth()/o),p=Math.floor(h.effectiveHeight()/a);r.rangeRound([0,h.effectiveWidth()]),e.rangeRound([h.effectiveHeight(),0]);var m=i.selectAll("g.box-group").data(h.data(),(function(t,e){return h.keyAccessor()(t,e)+"\0"+h.valueAccessor()(t,e)}));m.exit().remove();var y=m.enter().append("g").attr("class","box-group");y.append("rect").attr("class","heat-box").attr("fill","white").attr("x",(function(t,e){return r(h.keyAccessor()(t,e))})).attr("y",(function(t,n){return e(h.valueAccessor()(t,n))})).on("click",h.boxOnClick()),h.renderTitle()&&(y.append("title"),m.select("title").text(h.title())),m=y.merge(m),n.transition(m.select("rect"),h.transitionDuration(),h.transitionDelay()).attr("x",(function(t,e){return r(h.keyAccessor()(t,e))})).attr("y",(function(t,n){return e(h.valueAccessor()(t,n))})).attr("rx",d).attr("ry",f).attr("fill",h.getColor).attr("width",g).attr("height",p);var v=i.select("g.cols");v.empty()&&(v=i.append("g").attr("class","cols axis"));var x=v.selectAll("text").data(r.domain());x.exit().remove(),x=x.enter().append("text").attr("x",(function(t){return r(t)+g/2})).style("text-anchor","middle").attr("y",h.effectiveHeight()).attr("dy",12).on("click",h.xAxisOnClick()).text(h.colsLabel()).merge(x),n.transition(x,h.transitionDuration(),h.transitionDelay()).text(h.colsLabel()).attr("x",(function(t){return r(t)+g/2})).attr("y",h.effectiveHeight());var A=i.select("g.rows");A.empty()&&(A=i.append("g").attr("class","rows axis"));var b=A.selectAll("text").data(e.domain());return b.exit().remove(),b=b.enter().append("text").style("text-anchor","end").attr("x",0).attr("dx",-2).attr("y",(function(t){return e(t)+p/2})).attr("dy",6).on("click",h.yAxisOnClick()).text(h.rowsLabel()).merge(b),n.transition(b,h.transitionDuration(),h.transitionDelay()).text(h.rowsLabel()).attr("y",(function(t){return e(t)+p/2})),h.hasFilter()?h.selectAll("g.box-group").each((function(t){h.isSelectedNode(t)?h.highlightSelected(this):h.fadeDeselected(this)})):h.selectAll("g.box-group").each((function(){h.resetHighlight(this)})),h},h.boxOnClick=function(t){return arguments.length?(v=t,h):v},h.xAxisOnClick=function(t){return arguments.length?(m=t,h):m},h.yAxisOnClick=function(t){return arguments.length?(y=t,h):y},h.xBorderRadius=function(t){return arguments.length?(d=t,h):d},h.yBorderRadius=function(t){return arguments.length?(f=t,h):f},h.isSelectedNode=function(t){return h.hasFilter(t.key)},h.anchor(e,r)},function(){function e(t){return[0,t.length-1]}function r(e){return[t.quantile(e,.25),t.quantile(e,.5),t.quantile(e,.75)]}t.box=function(){var i=1,a=1,o=0,l=null,u=Number,c=e,s=r,d=null;function f(e){e.each((function(e,n){e=e.map(u).sort(t.ascending);var r=t.select(this),f=e.length,h=e[0],g=e[f-1],p=e.quartiles=s(e),m=c&&c.call(this,e,n),y=m&&m.map((function(t){return e[t]})),v=m?t.range(0,m[0]).concat(t.range(m[1]+1,f)):t.range(f),x=t.scaleLinear().domain(l&&l.call(this,e,n)||[h,g]).range([a,0]),A=this.__chart__||t.scaleLinear().domain([0,1/0]).range(x.range());this.__chart__=x;var b=r.selectAll("line.center").data(y?[y]:[]);b.enter().insert("line","rect").attr("class","center").attr("x1",i/2).attr("y1",(function(t){return A(t[0])})).attr("x2",i/2).attr("y2",(function(t){return A(t[1])})).style("opacity",1e-6).transition().duration(o).delay(0).style("opacity",1).attr("y1",(function(t){return x(t[0])})).attr("y2",(function(t){return x(t[1])})),b.transition().duration(o).delay(0).style("opacity",1).attr("x1",i/2).attr("x2",i/2).attr("y1",(function(t){return x(t[0])})).attr("y2",(function(t){return x(t[1])})),b.exit().transition().duration(o).delay(0).style("opacity",1e-6).attr("y1",(function(t){return x(t[0])})).attr("y2",(function(t){return x(t[1])})).remove();var w=r.selectAll("rect.box").data([p]);w.enter().append("rect").attr("class","box").attr("x",0).attr("y",(function(t){return A(t[2])})).attr("width",i).attr("height",(function(t){return A(t[0])-A(t[2])})).transition().duration(o).delay(0).attr("y",(function(t){return x(t[2])})).attr("height",(function(t){return x(t[0])-x(t[2])})),w.transition().duration(o).delay(0).attr("width",i).attr("y",(function(t){return x(t[2])})).attr("height",(function(t){return x(t[0])-x(t[2])}));var _=r.selectAll("line.median").data([p[1]]);_.enter().append("line").attr("class","median").attr("x1",0).attr("y1",A).attr("x2",i).attr("y2",A).transition().duration(o).delay(0).attr("y1",x).attr("y2",x),_.transition().duration(o).delay(0).attr("x1",0).attr("x2",i).attr("y1",x).attr("y2",x);var k=r.selectAll("line.whisker").data(y||[]);k.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",A).attr("x2",i).attr("y2",A).style("opacity",1e-6).transition().duration(o).delay(0).attr("y1",x).attr("y2",x).style("opacity",1),k.transition().duration(o).delay(0).attr("x1",0).attr("x2",i).attr("y1",x).attr("y2",x).style("opacity",1),k.exit().transition().duration(o).delay(0).attr("y1",x).attr("y2",x).style("opacity",1e-6).remove();var D=r.selectAll("circle.outlier").data(v,Number);D.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",i/2).attr("cy",(function(t){return A(e[t])})).style("opacity",1e-6).transition().duration(o).delay(0).attr("cy",(function(t){return x(e[t])})).style("opacity",1),D.transition().duration(o).delay(0).attr("cx",i/2).attr("cy",(function(t){return x(e[t])})).style("opacity",1),D.exit().transition().duration(o).delay(0).attr("cy",(function(t){return x(e[t])})).style("opacity",1e-6).remove();var L=d||x.tickFormat(8),C=r.selectAll("text.box").data(p);C.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",(function(t,e){return 1&e?6:-6})).attr("x",(function(t,e){return 1&e?i:0})).attr("y",A).attr("text-anchor",(function(t,e){return 1&e?"start":"end"})).text(L).transition().duration(o).delay(0).attr("y",x),C.transition().duration(o).delay(0).text(L).attr("x",(function(t,e){return 1&e?i:0})).attr("y",x);var O=r.selectAll("text.whisker").data(y||[]);O.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",i).attr("y",A).text(L).style("opacity",1e-6).transition().duration(o).delay(0).attr("y",x).style("opacity",1),O.transition().duration(o).delay(0).text(L).attr("x",i).attr("y",x).style("opacity",1),O.exit().transition().duration(o).delay(0).attr("y",x).style("opacity",1e-6).remove()})),t.timerFlush()}return f.width=function(t){return arguments.length?(i=t,f):i},f.height=function(t){return arguments.length?(a=t,f):a},f.tickFormat=function(t){return arguments.length?(d=t,f):d},f.duration=function(t){return arguments.length?(o=t,f):o},f.domain=function(t){return arguments.length?(l=null===t||"function"==typeof t?t:n.utils.constant(t),f):l},f.value=function(t){return arguments.length?(u=t,f):u},f.whiskers=function(t){return arguments.length?(c=t,f):c},f.quartiles=function(t){return arguments.length?(s=t,f):s},f}}(),n.boxPlot=function(e,r){var i=n.coordinateGridMixin({});var a=function(t){return function(e){var n=e.quartiles[0],r=e.quartiles[2],i=(r-n)*t,a=-1,o=e.length;do{++a}while(e[a]<n-i);do{--o}while(e[o]>r+i);return[a,o]}}(1.5),o=t.box(),l=null,u=function(t,e){return i.isOrdinal()?i.x().bandwidth():t/(1+i.boxPadding())/e};i.yAxisPadding(12),i.x(t.scaleBand()),i.xUnits(n.units.ordinal),i.data((function(t){return t.all().map((function(t){return t.map=function(e){return e.call(t,t)},t})).filter((function(t){return 0!==i.valueAccessor()(t).length}))})),i.boxPadding=i._rangeBandPadding,i.boxPadding(.8),i.outerPadding=i._outerRangeBandPadding,i.outerPadding(.5),i.boxWidth=function(t){return arguments.length?(u="function"==typeof t?t:n.utils.constant(t),i):u};var c=function(t,e){return"translate("+i.x()(i.keyAccessor()(t,e))+", 0)"};return i._preprocessData=function(){i.elasticX()&&i.x().domain([])},i.plotData=function(){var e=u(i.effectiveWidth(),i.xUnitCount());o.whiskers(a).width(e).height(i.effectiveHeight()).value(i.valueAccessor()).domain(i.y().domain()).duration(i.transitionDuration()).tickFormat(l);var r=i.chartBodyG().selectAll("g.box").data(i.data(),i.keyAccessor()),s=function(t){var e=t.enter().append("g");return e.attr("class","box").attr("transform",c).call(o).on("click",(function(t){i.filter(i.keyAccessor()(t)),i.redrawGroup()})),e.merge(t)}(r);!function(e){n.transition(e,i.transitionDuration(),i.transitionDelay()).attr("transform",c).call(o).each((function(){t.select(this).select("rect.box").attr("fill",i.getColor)}))}(s),function(t){t.exit().remove().call(o)}(r),i.fadeDeselectedArea(i.filter())},i.fadeDeselectedArea=function(t){if(i.hasFilter())if(i.isOrdinal())i.g().selectAll("g.box").each((function(t){i.isSelectedNode(t)?i.highlightSelected(this):i.fadeDeselected(this)}));else{if(!i.brushOn()&&!i.parentBrushOn())return;var e=t[0],n=t[1],r=i.keyAccessor();i.g().selectAll("g.box").each((function(t){var a=r(t);a<e||a>=n?i.fadeDeselected(this):i.highlightSelected(this)}))}else i.g().selectAll("g.box").each((function(){i.resetHighlight(this)}))},i.isSelectedNode=function(t){return i.hasFilter(i.keyAccessor()(t))},i.yAxisMin=function(){var e=t.min(i.data(),(function(e){return t.min(i.valueAccessor()(e))}));return n.utils.subtract(e,i.yAxisPadding())},i.yAxisMax=function(){var e=t.max(i.data(),(function(e){return t.max(i.valueAccessor()(e))}));return n.utils.add(e,i.yAxisPadding())},i.tickFormat=function(t){return arguments.length?(l=t,i):l},i.anchor(e,r)},n.selectMenu=function(e,r){var i,a="dc-select-option",o=n.baseMixin({}),l="Select all",u=!1,c=null,s=null,d=function(t,e){return o.keyAccessor()(t)>o.keyAccessor()(e)?1:o.keyAccessor()(e)>o.keyAccessor()(t)?-1:0},f=function(t){return o.valueAccessor()(t)>0};o.data((function(t){return t.all().filter(f)})),o._doRender=function(){return o.select("select").remove(),(i=o.root().append("select").classed("dc-select-menu",!0)).append("option").text(l).attr("value",""),o._doRedraw(),o};var h=window.navigator.userAgent;function g(e,n){var r,i=t.event.target;i.selectedOptions?r=Array.prototype.slice.call(i.selectedOptions).map((function(t){return t.value})):r=[].slice.call(t.event.target.options).filter((function(t){return t.selected})).map((function(t){return t.value}));1===r.length&&""===r[0]?r=c||null:u||1!==r.length||(r=r[0]),o.onChange(r)}return h.indexOf("Trident/")>0&&-1===h.indexOf("MSIE")&&(o.redraw=o.render),o._doRedraw=function(){var t;return function(){u?i.attr("multiple",!0):i.attr("multiple",null);null!==s?i.attr("size",s):i.attr("size",null)}(),(t=i.selectAll("option."+a).data(o.data(),(function(t){return o.keyAccessor()(t)}))).exit().remove(),t.enter().append("option").classed(a,!0).attr("value",(function(t){return o.keyAccessor()(t)})).merge(t).text(o.title()),i.selectAll("option."+a).sort(d),i.on("change",g),o.hasFilter()&&u?i.selectAll("option").property("selected",(function(t){return void 0!==t&&o.filters().indexOf(String(o.keyAccessor()(t)))>=0})):o.hasFilter()?i.property("value",o.filter()):i.property("value",""),o},o.onChange=function(t){t&&u?o.replaceFilter([t]):t?o.replaceFilter(t):o.filterAll(),n.events.trigger((function(){o.redrawGroup()}))},o.order=function(t){return arguments.length?(d=t,o):d},o.promptText=function(t){return arguments.length?(l=t,o):l},o.filterDisplayed=function(t){return arguments.length?(f=t,o):f},o.multiple=function(t){return arguments.length?(u=t,o):u},o.promptValue=function(t){return arguments.length?(c=t,o):c},o.numberVisible=function(t){return arguments.length?(s=t,o):s},o.size=n.logger.deprecate(o.numberVisible,"selectMenu.size is ambiguous - use numberVisible instead"),o.anchor(e,r)},n.textFilterWidget=function(t,e){var r=n.baseMixin({}),i=function(t){return t.toLowerCase()},a=function(t){return t=i(t),function(e){return-1!==i(e).indexOf(t)}},o="search";return r.group((function(){throw"the group function on textFilterWidget should never be called, please report the issue"})),r._doRender=function(){return r.select("input").remove(),r.root().append("input").classed("dc-text-filter-input",!0).on("input",(function(){r.dimension().filterFunction(a(this.value)),n.events.trigger((function(){n.redrawAll()}),n.constants.EVENT_DELAY)})),r._doRedraw(),r},r._doRedraw=function(){return r.root().selectAll("input").attr("placeholder",o),r},r.normalize=function(t){return arguments.length?(i=t,r):i},r.placeHolder=function(t){return arguments.length?(o=t,r):o},r.filterFunctionFactory=function(t){return arguments.length?(a=t,r):a},r.anchor(t,e)},n.cboxMenu=function(e,r){var i,a="dc-cbox-item",o=n.baseMixin({}),l="Select all",u=!1,c="radio",s=null,d=Math.floor(1e5*Math.random())+1,f=function(t,e){return o.keyAccessor()(t)>o.keyAccessor()(e)?1:o.keyAccessor()(e)>o.keyAccessor()(t)?-1:0},h=function(t){return o.valueAccessor()(t)>0};function g(e,n){var r;t.select(t.event.target).datum()?(r=t.select(this).selectAll("input").filter((function(t){if(t)return this.checked})).nodes().map((function(t){return t.value})),u||1!==r.length||(r=r[0])):r=s||null,o.onChange(r)}return o.data((function(t){return t.all().filter(h)})),o._doRender=function(){return o._doRedraw()},o._doRedraw=function(){return o.select("ul").remove(),i=o.root().append("ul").classed("dc-cbox-group",!0),function(){var t=i.selectAll("li."+a).data(o.data(),(function(t){return o.keyAccessor()(t)}));if(t.exit().remove(),(t=t.enter().append("li").classed(a,!0).merge(t)).append("input").attr("type",c).attr("value",(function(t){return o.keyAccessor()(t)})).attr("name","domain_"+d).attr("id",(function(t,e){return"input_"+d+"_"+e})),t.append("label").attr("for",(function(t,e){return"input_"+d+"_"+e})).text(o.title()),u)i.append("li").append("input").attr("type","reset").text(l).on("click",g);else{var e=i.append("li");e.append("input").attr("type",c).attr("value",s).attr("name","domain_"+d).attr("id",(function(t,e){return"input_"+d+"_all"})).property("checked",!0),e.append("label").attr("for",(function(t,e){return"input_"+d+"_all"})).text(l)}i.selectAll("li."+a).sort(f),i.on("change",g)}(),o.hasFilter()&&u?i.selectAll("input").property("checked",(function(t){return t&&o.filters().indexOf(String(o.keyAccessor()(t)))>=0||!1})):o.hasFilter()&&i.selectAll("input").property("checked",(function(t){return!!t&&o.keyAccessor()(t)===o.filter()})),o},o.onChange=function(t){t&&u?o.replaceFilter([t]):t?o.replaceFilter(t):o.filterAll(),n.events.trigger((function(){o.redrawGroup()}))},o.order=function(t){return arguments.length?(f=t,o):f},o.promptText=function(t){return arguments.length?(l=t,o):l},o.filterDisplayed=function(t){return arguments.length?(h=t,o):h},o.multiple=function(t){return arguments.length?(c=(u=t)?"checkbox":"radio",o):u},o.promptValue=function(t){return arguments.length?(s=t,o):s},o.anchor(e,r)},n.abstractBubbleChart=n.bubbleMixin,n.baseChart=n.baseMixin,n.capped=n.capMixin,n.colorChart=n.colorMixin,n.coordinateGridChart=n.coordinateGridMixin,n.marginable=n.marginMixin,n.stackableChart=n.stackMixin,n.d3=t,n.crossfilter=e,n}if("function"==typeof define&&define.amd)define(["d3","crossfilter2"],t);else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){var e=require("d3"),n=require("crossfilter2");"function"!=typeof n&&(n=n.crossfilter),module.exports=t(e,n)}else this.dc=t(d3,crossfilter)}();var PODLOVE=PODLOVE||{};PODLOVE.Analytics=PODLOVE.Analytics||{},dc.config.defaultColors(d3.schemeAccent),PODLOVE.Analytics.decimalRound=function(t,e){var n=Math.pow(10,e);return t*=n,t=Math.round(t),t/=n},PODLOVE.Analytics.formatThousands=function(t){return t<1e3?t:PODLOVE.Analytics.decimalRound(t/1e3,1)+"k"},PODLOVE.Analytics.hourFormat=function(t){var e=0,n=0,r=[];return t>48&&(e=(t-t%24)/24,t%=24),e>13&&(n=(e-e%7)/7,e%=7),n&&r.push(PODLOVE.Analytics.decimalRound(n,1)+"w"),e&&r.push(PODLOVE.Analytics.decimalRound(e,1)+"d"),t&&r.push(PODLOVE.Analytics.decimalRound(t,1)+"h"),0===r.length&&(r=["0h"]),r.join(" ")},PODLOVE.Analytics.addPercentageLabels=function(t,e){var n=t.data(),r=t.filters();n.forEach((function(n,i){var a=t.select("g.row._"+i),o=t.select("g.row._"+i+" text"),l="";a.select(".subLabel").size()||a.append("text").attr("class","subLabel").attr("text-anchor","end").attr("x",-10).attr("y",o.attr("y")),r.length>0&&r.includes(n.key)?a.select(".subLabel").style({display:"none"}):a.select(".subLabel").style({display:"inherit"}),e>0&&(l=Math.round(n.value/e*100)+"%"),a.select(".subLabel").text(l)}))},Number.isNaN=Number.isNaN||function(t){return t!=t},jQuery(document).ready((function(t){var e,n,r,i,a=d3.timeFormat("%Y-%m-%d %H:%M %Z"),o=jQuery("#episode-performance-chart").data("episode"),l=t("#episode-performance-chart").closest(".inside").width(),u={min:null,max:null},c=function(t,e){return t.downloads+=e.downloads,t.asset_id=e.asset_id,t.date=t.date&&t.date<e.date?t.date:e.date,t.client=e.client,t.system=e.system,t.source=e.source,t.context=e.context,t.geo=e.geo,t},s=function(t,e){return t.downloads-=e.downloads,t},d=function(){return{downloads:0,asset_id:0,date:0,client:"",system:"",geo:""}};function f(o){var f=o.hours_per_unit,h=crossfilter(e),g=crossfilter(n),p=h.groupAll().reduce(c,s,d),m=function(t){var e=t.data(),n=t.filters();e.forEach((function(e,r){var i=t.select("g.row._"+r),a=t.select("g.row._"+r+" text"),o="";i.select(".subLabel").size()||i.append("text").attr("class","subLabel").attr("text-anchor","end").attr("x",-10).attr("y",a.attr("y")),n.length>0&&n.includes(e.key)?i.select(".subLabel").style({display:"none"}):i.select(".subLabel").style({display:"inherit"}),p.value().downloads>0&&(o=Math.round(e.value.downloads/p.value().downloads*100)+"%"),i.select(".subLabel").text(o)}))},y=function(t,e){t.select(".reset").on("click",(function(e,n){d3.event.preventDefault(),t.filterAll(),dc.redrawAll()}))},v=function(t){return Math.floor(t.hoursSinceRelease/f)},x=h.dimension(v),A=g.dimension(v),b=h.dimension((function(t){return t.asset_id})),w=h.dimension((function(t){return t.client})),_=h.dimension((function(t){return t.system})),k=h.dimension((function(t){return t.source})),D=h.dimension((function(t){return t.context})),L=h.dimension((function(t){return t.geo})),C=x.group().reduce(c,s,d),O=A.group().reduce(c,s,d),E=x.group().reduce(c,s,d).all().reduce((function(t,e){return e.key+=1,e.value.cum=!0,t.length&&(e.value.downloads+=t.slice(-1)[0].value.downloads),t.push(e),t}),[]);E.unshift({key:0,value:{date:0,downloads:0,cum:!0}});var S={all:function(){return E}},R=b.group().reduce(c,s,d),M=w.group().reduce(c,s,d).order((function(t){return t.downloads})),F=_.group().reduce(c,s,d).order((function(t){return t.downloads})),T=k.group().reduce(c,s,d),B=D.group().reduce(c,s,d),N=L.group().reduce(c,s,d),P="#69B3FF",H=dc.compositeChart("#episode-performance-chart"),G=dc.barChart(H).dimension(x).group(C,"Current Episode").renderTitle(!0).valueAccessor((function(t){return t.value.downloads})).gap(1).colors(P),V=dc.barChart(H).dimension(x).group(O,"Average Episode").renderTitle(!0).colors("#224BA6").valueAccessor((function(t){return t.value.downloads})).barPadding(2),U=dc.lineChart(H).dimension(x).group(S,"Cumulative").colors("#CCC").useRightYAxis(!0).valueAccessor((function(t){return t.value.downloads})).renderDataPoints({}).renderArea(!0),z=C.all().reduce((function(t,e){return Math.max(t,e.key)}),0),I=dc.barChart("#episode-range-chart").width(l).height(80).dimension(x).group(C).x(d3.scaleLinear().domain([0,z])).valueAccessor((function(t){return t.value.downloads})).colors(P).yAxisLabel(" ");window.rangeChart=I,H.width(l).x(d3.scaleLinear().domain([0,1/0])).legend(dc.legend().x(l-160).y(20).itemHeight(13).gap(5)).elasticX(!1).brushOn(!1).transitionDuration(0).yAxisLabel("Downloads").xAxisLabel("Hours since release").rangeChart(I).title((function(t){return[t.value.date?a(t.value.date):"Average Episode",t.value.cum?t.key*f+"h after release":t.key*f+"h  "+(t.key+1)*f+"h after release","Downloads: "+t.value.downloads].join("\n")})).compose([U,G,V]).rightYAxisLabel("Cumulative Downloads");var Y=dc.rowChart("#episode-asset-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(b).group(R).valueAccessor((function(t){return t.value?t.value.downloads:0})).ordering((function(t){return-t.value.downloads})).label((function(t){return assetNames[t.key]})).title((function(t){return t.value.downloads})).colors(P).on("preRedraw",m).on("renderlet",y),j=dc.rowChart("#episode-client-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(w).group(M).valueAccessor((function(t){return t.value.downloads})).ordering((function(t){return-t.value.downloads})).othersGrouper((function(t){return t})).cap(10).label((function(t){return t.key})).colors(P).on("preRedraw",m).on("renderlet",y),X=dc.rowChart("#episode-system-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(_).group(F).valueAccessor((function(t){return t.value.downloads})).ordering((function(t){return-t.value.downloads})).othersGrouper((function(t){return t})).cap(10).label((function(t){return t.key})).colors(P).on("preRedraw",m).on("renderlet",y),q=dc.rowChart("#episode-source-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(k).group(T).valueAccessor((function(t){return t.value.downloads})).ordering((function(t){return-t.value.downloads})).label((function(t){return t.key})).colors(P).on("preRedraw",m).on("renderlet",y),W=dc.rowChart("#episode-context-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(D).group(B).valueAccessor((function(t){return t.value.downloads})).ordering((function(t){return-t.value.downloads})).label((function(t){return t.value.source+"/"+t.key})).colors(P).on("preRedraw",m).on("renderlet",y),K=dc.rowChart("#episode-geo-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).cap(10).dimension(L).group(N).valueAccessor((function(t){return t.value.downloads})).ordering((function(t){return-t.value.downloads})).othersGrouper((function(t){return t})).colors(P).on("preRedraw",m).on("renderlet",y);I.yAxis().ticks([2]),I.xAxis().tickFormat((function(t){return PODLOVE.Analytics.hourFormat(t*f)})),H.xAxis().tickFormat((function(t){return PODLOVE.Analytics.hourFormat(t*f)})),I.yAxis().tickFormat(PODLOVE.Analytics.formatThousands),H.yAxis().tickFormat(PODLOVE.Analytics.formatThousands),H.rightYAxis().tickFormat(PODLOVE.Analytics.formatThousands),Y.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),j.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),X.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),q.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),W.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),K.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),r=function(){H.elasticY(!0).compose([U,G,V]),H.render()},i=function(){H.elasticY(!0).compose([U,G]),H.render()},[H,I,Y,j,X,q,W,K].forEach((function(t){t.render()}));var Q=function(t,e){dc.filterAll(),I.filter(dc.filters.RangedFilter(t/f,e/f)),dc.redrawAll()};window.filterHours=Q,u.min||u.max||(u.min=0,u.max=168,t("#chart-zoom-selection .button:eq(1)").addClass("active")),t("#chart-zoom-selection .button").on("click",(function(e){var n=parseInt(t(this).data("hours"),10);e.preventDefault(),t(this).hasClass("disabled")||(t(this).siblings().removeClass("active"),t(this).addClass("active"),0===n?(u.min=0,u.max=I.xUnitCount()*f):u.max=u.min+n,Q(u.min,u.max))})),o.rendered&&o.rendered instanceof Function&&o.rendered()}t("#chart-grouping-selection").on("click","a",(function(r){var i,a=parseInt(t(this).data("hours"),10),l=parseInt(t("#chart-zoom-selection .button.active").data("hours"),10);t(this).siblings().removeClass("active"),t(this).addClass("active"),t("#chart-zoom-selection a.button").each((function(){var e=parseInt(t(this).data("hours"),10);0!==e&&e<a?t(this).addClass("disabled"):t(this).removeClass("disabled")})),i={hours_per_unit:a,rendered:function(){0!==l&&(Number.isNaN(l)||l<a)?t("#chart-zoom-selection a.button").filter((function(){var e=parseInt(t(this).data("hours"),10);return 0===e||e>=a})).first().click():t("#chart-zoom-selection a.button.active:first").click()}},e?f(i):t.when(t.ajax(ajaxurl+"?action=podlove-analytics-episode-downloads-per-hour&episode="+o),t.ajax(ajaxurl+"?action=podlove-analytics-episode-average-downloads-per-hour")).done((function(t,r){e=d3.csvParse(t[0],(function(t){return{date:new Date(1e3*+t.date),downloads:+t.downloads,hoursSinceRelease:+t.hours_since_release,asset_id:+t.asset_id,client:t.client?t.client:"Unknown",system:t.system?t.system:"Unknown",source:t.source?t.source:"Unknown",context:t.context?t.context:"Unknown",geo:t.geo?t.geo:"Unknown"}})),n=d3.csvParse(r[0],(function(t){return{hoursSinceRelease:+t.hoursSinceRelease,downloads:+t.downloads}})),f(i)})),r.preventDefault()})),t("#chart-grouping-selection a:eq(3)").click(),t("input[name='podlove_analytics_tiles']").each((function(){var e=t(this).attr("checked"),n=t(this).val(),r=t(".chart-wrapper[data-tile-id='"+n+"']");e||r.hide()})).on("click",(function(){var e=t(this).attr("checked"),n=t(this).val(),r=t(".chart-wrapper[data-tile-id='"+n+"']");t.ajax({url:ajaxurl,data:{action:"podlove-analytics-settings-tiles-update",tile_id:n,checked:e}}),e?r.show():r.hide()}));var h=function e(){void 0===i?window.setTimeout(e,500):t("#average-episode").attr("checked")?r():i()};t("#average-episode").each(h).on("click",(function(){!function(){t.ajax({url:ajaxurl,data:{action:"podlove-analytics-settings-avg-update",checked:t(this).attr("checked")}})}(),h()}))})),jQuery(document).ready((function(t){var e,n,r=function(t,e){return t.downloads+=e.downloads,t.episode_id=e.episode_id,t.date=e.date,t},i=function(t,e){return t.downloads-=e.downloads,t},a=function(){return{downloads:0,episode_id:0,date:0}};function o(){var n=t("#total-chart").closest(".wrap").width(),o=crossfilter(e),l=o.groupAll().reduce(r,i,a).value().downloads,u=o.dimension((function(t){return d3.timeDay(t.date)})),c=o.dimension((function(t){return t.episode_id})).group().reduce((function(t,e){return t.downloads+=e.downloads,t.episode_id=e.episode_id,t}),null,(function(){return{downloads:0,episode_id:0}})).all().reduce((function(t,e){return e.value.downloads>.04*l&&t.push(e),t}),[]),s=_.pluck(c,"key"),d=u.group().reduce((function(t,e){return _.contains(s,e.episode_id)?t:r(t,e)}),(function(t,e){return _.contains(s,e.episode_id)?t:i(t,e)}),a),f=function(t,e){return t.group().reduce((function(t,n){return n.episode_id==e?r(t,n):t}),(function(t,n){return n.episode_id==e?i(t,n):t}),a)},h=[];for(var g in s)h[s[g]]=f(u,s[g]);var p,m=d3.timeFormat("%Y-%m-%d"),y=dc.barChart("#total-chart").width(n).height(200).dimension(u).group(d,"Other Episodes").x(d3.scaleTime().domain([(p=28,new Date((new Date).setDate((new Date).getDate()-p))),new Date])).xUnits(d3.timeDays).brushOn(!1).renderTitle(!0).elasticY(!0).yAxisLabel("Downloads").valueAccessor((function(t){return t.value.downloads})).title((function(t){return[m(t.key),"Downloads: "+t.value.downloads].join("\n")})).renderHorizontalGridLines(!0);if(n>650){var v=n-300;jQuery("#total-chart").height("200px"),y.height(200),y.legend(dc.legend().horizontal(!1).x(v).y(10).autoItemWidth(!0)),y.margins().bottom=30,y.margins().right=305}else{v=n-300;var x=50+13*c.length,A=240+x+30;console.log({chartHeight:240,legendHeight:x,padding:30,totalHeight:A}),jQuery("#total-chart").height(A),y.height(A),y.legend(dc.legend().horizontal(!1).x(30).y(270).autoItemWidth(!0)),y.margins().bottom=x+30}for(var g in h)y.stack(h[g],podlove_episode_names[g]);y.yAxis().tickFormat(PODLOVE.Analytics.formatThousands),y.xAxis().tickFormat(d3.timeFormat("%d %b")),n<550?y.xAxis().ticks(d3.timeDay,5):n<635?y.xAxis().ticks(d3.timeDay,4):n<780?y.xAxis().ticks(d3.timeDay,3):y.xAxis().ticks(d3.timeDay,2),y.render()}function l(t,e,n,r,i){return dc.lineChart(t).dimension(e).group(n,r).colors(i).defined((function(t){return null!=t.y}))}function u(t){return function(e,n){return null===n[t]&&null===e?null:e+=n[t]}}function c(t){return function(e,n){return null===n[t]&&null===e?null:e-=n[t]}}function s(t){return null}function d(){var e=t("#total-abo-chart").closest(".wrap").width(),r=crossfilter(n).dimension((function(t){return t.number})),i=r.group().reduceSum((function(t){return t.downloads})),a=r.group().reduce(u("q1"),c("q1"),s),o=r.group().reduce(u("d1"),c("d1"),s),d=r.group().reduce(u("w1"),c("w1"),s),f=dc.compositeChart("#total-abo-chart"),h=function(t,e,n,r){return dc.barChart(t).dimension(e).colors("#cccccc").centerBar(!0).group(n,r)}(f,r,i,"Total"),g=l(f,r,a,"1q","#aa0000"),p=l(f,r,d,"1w","#8b008b"),m=l(f,r,o,"1d","#3a539b");f.width(e).x(d3.scaleBand().domain(r)).xUnits(dc.units.ordinal).elasticX(!0).brushOn(!1).yAxisLabel("Downloads").group(i)._rangeBandPadding(1).title((function(t){return[n[t.key].title,"Downloads: "+t.value].join("\n")})).renderHorizontalGridLines(!0).compose([h,m,p,g]);if(e>650){var y=e-300;jQuery("#total-abo-chart").height("200px"),f.height(200),f.legend(dc.legend().horizontal(!1).x(y).y(10).autoItemWidth(!0)),f.margins().bottom=30,f.margins().right=305}else{y=e-300;jQuery("#total-abo-chart").height("370px"),f.height(370),f.legend(dc.legend().horizontal(!1).x(30).y(170).autoItemWidth(!0)),f.margins().bottom=230}f.render()}function f(t){return t?+t:null}t("#total-chart").length&&(e?(o(),t(window).on("resize",o)):t.when(t.ajax(ajaxurl+"?action=podlove-analytics-total-downloads-per-day")).done((function(n){e=d3.csvParse(n,(function(t){return{date:new Date(1e3*+t.date),downloads:+t.downloads,episode_id:+t.episode_id}})),o(),t(window).on("resize",o)}))),t("#total-abo-chart").length&&(n?(d(),t(window).on("resize",d)):t.when(t.ajax(ajaxurl+"?action=podlove-analytics-csv-episodes-table")).done((function(e){var r=0;n=d3.csvParse(e,(function(t){return{number:r++,title:t.title,downloads:+t.downloads,d1:f(t["1d"]),d2:f(t["2d"]),w1:f(t["1w"]),q1:f(t["1q"])}})),d(),t(window).on("resize",d)})));var h="#69B3FF",g=[{id:"#analytics-chart-global-assets",action:"podlove-analytics-global-assets",mapper:function(t){return{downloads:+t.downloads,asset:t.asset?t.asset:"Unknown"}},renderer:function(t){var e=crossfilter(t),n=e.dimension((function(t){return t.asset})),r=n.group().reduceSum((function(t){return t.downloads})),i=e.groupAll().reduceSum((function(t){return t.downloads})).value(),a=dc.rowChart("#analytics-chart-global-assets").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(n).group(r).valueAccessor((function(t){return t.value?t.value:0})).ordering((function(t){return-t.value})).colors(h).on("renderlet",(function(t){return PODLOVE.Analytics.addPercentageLabels(t,i)}));a.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),a.render()}},{id:"#analytics-chart-global-clients",action:"podlove-analytics-global-clients",mapper:function(t){return{downloads:+t.downloads,client_name:t.client_name?t.client_name:"Unknown"}},renderer:function(t){var e=crossfilter(t),n=e.dimension((function(t){return t.client_name})),r=n.group().reduceSum((function(t){return t.downloads})),i=e.groupAll().reduceSum((function(t){return t.downloads})).value(),a=dc.rowChart("#analytics-chart-global-clients").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(n).group(r).valueAccessor((function(t){return t.value?t.value:0})).ordering((function(t){return-t.value})).othersGrouper((function(t){return t})).colors(h).cap(10).on("renderlet",(function(t){return PODLOVE.Analytics.addPercentageLabels(t,i)}));a.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),a.render()}},{id:"#analytics-chart-global-systems",action:"podlove-analytics-global-systems",mapper:function(t){return{downloads:+t.downloads,os_name:t.os_name?t.os_name:"Unknown"}},renderer:function(t){var e=crossfilter(t),n=e.dimension((function(t){return t.os_name})),r=n.group().reduceSum((function(t){return t.downloads})),i=e.groupAll().reduceSum((function(t){return t.downloads})).value(),a=dc.rowChart("#analytics-chart-global-systems").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(n).group(r).valueAccessor((function(t){return t.value?t.value:0})).ordering((function(t){return-t.value})).othersGrouper((function(t){return t})).colors(h).cap(10).on("renderlet",(function(t){return PODLOVE.Analytics.addPercentageLabels(t,i)}));a.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),a.render()}},{id:"#analytics-chart-global-sources",action:"podlove-analytics-global-sources",mapper:function(t){return{downloads:+t.downloads,source:t.source?t.source:"Unknown"}},renderer:function(t){var e=crossfilter(t),n=e.dimension((function(t){return t.source})),r=n.group().reduceSum((function(t){return t.downloads})),i=e.groupAll().reduceSum((function(t){return t.downloads})).value(),a=dc.rowChart("#analytics-chart-global-sources").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(n).group(r).valueAccessor((function(t){return t.value?t.value:0})).ordering((function(t){return-t.value})).othersGrouper((function(t){return t})).colors(h).on("renderlet",(function(t){return PODLOVE.Analytics.addPercentageLabels(t,i)}));a.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),a.render()}},{id:"#analytics-global-top-episodes",action:"podlove-analytics-global-top-episodes",mapper:function(t){return{downloads:+t.downloads,title:t.title?t.title:"Unknown"}},renderer:function(t){var e=crossfilter(t),n=e.dimension((function(t){return t.title})),r=n.group().reduceSum((function(t){return t.downloads})),i=e.groupAll().reduceSum((function(t){return t.downloads})).value(),a=dc.rowChart("#analytics-global-top-episodes").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(n).group(r).valueAccessor((function(t){return t.value?t.value:0})).ordering((function(t){return-t.value})).othersGrouper((function(t){return t})).colors(h).cap(10).on("renderlet",(function(t){return PODLOVE.Analytics.addPercentageLabels(t,i)}));a.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),a.render()}}],p=function(e){var n,r;e&&e.length?(n=e[0],r=e[1]):(n=new Date(0),r=new Date),function(e,n){var r=t("#analytics-global-downloads"),i=t("#analytics-global-downloads-value"),a=t(".chart-loading",r);a.show(),i.hide(),t.when(t.ajax(ajaxurl+"?action=podlove-analytics-global-total-downloads&date_from="+e.toDateString()+"&date_to="+n.toDateString())).done((function(t){a.hide(),i.html(t),i.show(),r.show()})).fail((function(){a.hide()}))}(n,r),function(e,n){var r=t("#analytics-global-shows"),i=t(".chart-loading",r),a=t(".chart-failed",r),o=t(".chart-nodata",r),l=t(".chart-content",r);r.length&&(i.show(),a.hide(),o.hide(),l.hide(),t.when(t.ajax(ajaxurl+"?action=podlove-analytics-global-total-downloads-by-show&date_from="+e.toDateString()+"&date_to="+n.toDateString())).done((function(t){i.hide(),console.log(t),l.html(t),l.show()})).fail((function(){i.hide(),a.show()})))}(n,r),g.forEach((function(e){var i=t(e.id+" .chart-loading"),a=t(e.id+" .chart-failed"),o=t(e.id+" .chart-nodata");t(e.id).each((function(){i.show(),a.hide(),o.hide(),t.when(t.ajax(ajaxurl+"?action="+e.action+"&date_from="+n.toISOString()+"&date_to="+r.toISOString())).done((function(t){var n=d3.csvParse(t,e.mapper);i.hide(),n.length||o.show(),(0,e.renderer)(n)})).fail((function(){i.hide(),a.show()}))}))}))};window.analyticsApp&&window.analyticsApp.$on("setChartRange",(function(t){p(t)}))}));
